{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Segment Routing Lab with Ansible","text":"Segment Routing with TI-LFA on Cisco XRv9k platform with Ansible <p>Must Read the Original</p> <p>This is a replica of the original Cisco-Segment-Routing-Lab. The only difference is that this time it is entirely implemented using ansible. Thus, without going into depth, I'll simply share the ansible configuration.</p> <p>Sinlge Playbook</p> <p>The whole lab guide is run as a single playbook, which is a collection of independent but interconnected plays that have been aggregated for simplicity of usage. The playbook is self-explanatory as well; for anything else, there is an online search or open github discussions/issues.</p>"},{"location":"#ansible","title":"Ansible","text":""},{"location":"#directory-structure-ansible-files-only","title":"Directory Structure (ansible files only)","text":"<p>Defaults</p> <p>The ansible play directory is arranged in such a manner that all of the folders (with names) and files (with names) are defaults, where ansible checks for variables and values.</p> <pre><code>.\n\u251c\u2500\u2500 0_revert_to_base_topology.yaml\n\u251c\u2500\u2500 10_tilfa_ns_prep.yaml\n\u251c\u2500\u2500 11_tilfa_ns_node.yaml\n\u251c\u2500\u2500 12_tilfa_ns_local_srlg.yaml\n\u251c\u2500\u2500 13_tilfa_ns_global_srlg.yaml\n\u251c\u2500\u2500 14_tilfa_ns_node_plus_srlg.yaml\n\u251c\u2500\u2500 15_tilfa_tiebrkr_link_node_srlg.yaml\n\u251c\u2500\u2500 1_getting_started.yaml\n\u251c\u2500\u2500 2_intro_segment_routing.yaml\n\u251c\u2500\u2500 3_sr_ldp_interworking.yaml\n\u251c\u2500\u2500 4_tilfa.yaml\n\u251c\u2500\u2500 5_zs_tilfa.yaml\n\u251c\u2500\u2500 6_ss_tilfa.yaml\n\u251c\u2500\u2500 7_ds_tilfa.yaml\n\u251c\u2500\u2500 8_microloop_avoidance.yaml\n\u251c\u2500\u2500 9_mpls_traffic_eng.yaml\n\u251c\u2500\u2500 all_inclusive_play.yaml\n\u251c\u2500\u2500 ansible.cfg\n\u251c\u2500\u2500 inventory\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 group_vars\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 routers.yaml\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 hosts.ini\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 host_vars\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 P2.yaml\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 P3.yaml\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 P4.yaml\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 P6.yaml\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 P7.yaml\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 P8.yaml\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 P9.yaml\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 PE1.yaml\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 PE5.yaml\n\u251c\u2500\u2500 templates\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 ds_tilfa.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 ds_tilfa_revert.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 iosxr_show_cef_5_5_5_5_32.ttp\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 iosxr_show_isis_adjacency.ttp\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 iosxr_show_mpls_forwarding_prefix.ttp\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 ip_igp_ldp_template.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 microloop_avoidance_p2_enable.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 microloop_avoidance_p2.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 microloop_avoidance_p2_restore.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 microloop_avoidance_p7_restore.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 microloop_avoidance_p8.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 microloop_avoidance_p8_trigger.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 mpls_traff_eng.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 prep_p9.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 restore_topology_template.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 sr_ldp_template.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 srms_template.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 sr_only_part1.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 sr_only_remove_ldp.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 sr_only_remove_srms.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 sr_prefer_template.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 sr_template.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 ss_tilfa_p7.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 tilfa.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 tilfa_ns_global_srlg_p2.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 tilfa_ns_global_srlg_p7.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 tilfa_ns_global_srlg_revert_p2.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 tilfa_ns_global_srlg_revert_p7.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 tilfa_ns_local_srlg.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 tilfa_ns_node.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 tilfa_ns_node_revert.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 tilfa_ns_prep_p4.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 tilfa_ns_prep_p6.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 tilfa_ns_prep_p7.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 tilfa_ns_prep_p8.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 tilfa_tiebrkr_prefer_link.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 tilfa_tiebrkr_prefer_node.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 tilfa_tiebrkr_prefer_srlg.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 zs_tilfa_p2.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 zs_tilfa_p6.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 zs_tilfa_p7.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 zs_tilfa_revert_p2.j2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 zs_tilfa_revert_p6.j2\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 zs_tilfa_revert_p7.j2\n\u2514\u2500\u2500 xrcfg\n</code></pre>"},{"location":"#configuration","title":"Configuration","text":"<pre><code>(vntdvops) lab@netdevops:~/github/ansible-cisco-segment-routing$ ansible-config view\n[defaults]\nhost_key_checking = False\ninventory = inventory/hosts.ini\nforks=30\nstdout_callback = yaml\ndisplay_skipped_hosts = false\n# https://www.redhat.com/sysadmin/faster-ansible-playbook-execution\n[ssh_connection]\nssh_args = -o ControlMaster=auto -o ControlPersist=60s\n[persistent_connection]\nconnect_timeout = 120\nconnect_retry_timeout = 30\n# The following is used to replace config as libssh has a bug\n#ssh_type = paramiko\n(vntdvops) lab@netdevops:~/github/ansible-cisco-segment-routing$ ansible-config\n</code></pre> <pre><code>(vntdvops) lab@netdevops:~/github/ansible-cisco-segment-routing$ ansible --version\nansible [core 2.14.3]\nconfig file = /home/lab/github/ansible-cisco-segment-routing/ansible.cfg\nconfigured module search path = ['/home/lab/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\nansible python module location = /home/lab/vntdvops/lib/python3.10/site-packages/ansible\nansible collection location = /home/lab/.ansible/collections:/usr/share/ansible/collections\nexecutable location = /home/lab/vntdvops/bin/ansible\npython version = 3.10.6 (main, Nov 14 2022, 16:10:14) [GCC 11.3.0] (/home/lab/vntdvops/bin/python)\njinja version = 3.1.2\nlibyaml = True\n(vntdvops) lab@netdevops:~/github/ansible-cisco-segment-routing$\n</code></pre>"},{"location":"#inventory","title":"Inventory","text":"<pre><code>(vntdvops) lab@netdevops:~/github/ansible-cisco-segment-routing$ ansible-inventory --graph\n@all:\n|--@ungrouped:\n|--@routers:\n|  |--PE1\n|  |--P2\n|  |--P3\n|  |--P4\n|  |--PE5\n|  |--P6\n|  |--P7\n|  |--P8\n|  |--P9\n|--@zstilfa:\n|  |--P2\n|  |--P6\n|  |--P7\n(vntdvops) lab@netdevops:~/github/ansible-cisco-segment-routing$\n</code></pre>"},{"location":"#host-variables-eg-pe1-individual-as-well-as-inherited-from-the-group","title":"Host Variables (e.g. PE1, individual as well as inherited from the group)","text":"<pre><code>(vntdvops) lab@netdevops:~/github/ansible-cisco-segment-routing$ ansible-inventory -y --host PE1\nansible_connection: ansible.netcommon.network_cli\nansible_network_os: cisco.iosxr.iosxr\nhostname: PE1\ninterfaces:\n- address: 1.1.1.1/32\ndescription: System_Loopback_Interface\nname: Loopback0\n- address: 12.0.0.1/24\ndescription: PE1_to_P2\nname: GigabitEthernet0/0/0/2\nprotocols:\nisis:\n- interfaces:\n- loopback: true\nname: Loopback0\n- loopback: false\nmetric: 10\nname: GigabitEthernet0/0/0/2\nnet: 49.0000.0000.0001.00\nsid: 1\n(vntdvops) lab@netdevops:~/github/ansible-cisco-segment-routing$\n</code></pre>"},{"location":"all_inclusive_play/","title":"Ansible-Playbook","text":""},{"location":"all_inclusive_play/#clone-the-repository","title":"Clone the Repository","text":"<p>This topology was created in EVE-NG using the Cisco XRv9k VM.</p> <p>Please also have a look at this one, which is based on Cisco XRd container platform.</p> <pre><code>(vntdvops) lab@netdevops:~/github$ git clone https://github.com/hmntsharma/ansible-cisco-segment-routing.git\nCloning into 'ansible-cisco-segment-routing'...\nremote: Enumerating objects: 208, done.\nremote: Counting objects: 100% (208/208), done.\nremote: Compressing objects: 100% (133/133), done.\nremote: Total 208 (delta 70), reused 188 (delta 64), pack-reused 0\nReceiving objects: 100% (208/208), 4.48 MiB | 10.11 MiB/s, done.\nResolving deltas: 100% (70/70), done.\n(vntdvops) lab@netdevops:~/github$\n</code></pre>"},{"location":"all_inclusive_play/#execute-the-playbook","title":"Execute the Playbook","text":"<p>Username: <code>cisco</code> | Password: <code>cisco</code></p> <p>Enter the password at the prompt.</p> <pre><code>(vntdvops) lab@netdevops:~/github/ansible-cisco-segment-routing$ ansible-playbook -u cisco -k all_inclusive_play.yaml\nSSH password:\n</code></pre> <p> </p> Base Topology"},{"location":"all_inclusive_play/#revert-to-base-topology","title":"Revert to Base Topology","text":"<pre><code>PLAY [0. RESTORE BASE TOPOLOGY] ************************************************\nTASK [0.0 RENDER AND DISPLAY THE BASE CONFIGURATION] ***************************\nok: [P2] =&gt; msg:\n- 'template: restore_topology_template.j2'\n- - username cisco\n- ' group root-lr'\n- ' group cisco-support'\n- ' secret 10 $6$m69UO/m0cK.e3O/.$EtYXDVl3/aphJkazxKy145fyIY/./Xxt1fi7B3tjYemXr6pzHEJRNfq1DxNJ..WlAQx4wFr6kJesSGtKLv8/k/'\n- '!'\n- call-home\n- ' service active'\n- ' contact smart-licensing'\n- ' profile CiscoTAC-1'\n- '  active'\n- '  destination transport-method email disable'\n- '  destination transport-method http'\n- ' !'\n- '!'\n- ''\n- interface MgmtEth0/RP0/CPU0/0\n- ' no ipv4 address dhcp'\n- ' ipv4 address 192.168.18.2 255.255.255.0'\n- ' no shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/0\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/1\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/2\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/3\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/4\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/5\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/6\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/7\n- ' shutdown'\n- '!'\n- ''\n- ssh client source-interface MgmtEth0/RP0/CPU0/0\n- ssh server vrf default\n- ''\n- root\n- '!'\n- ''\n- ''\nok: [P3] =&gt; msg:\n- 'template: restore_topology_template.j2'\n- - username cisco\n- ' group root-lr'\n- ' group cisco-support'\n- ' secret 10 $6$m69UO/m0cK.e3O/.$EtYXDVl3/aphJkazxKy145fyIY/./Xxt1fi7B3tjYemXr6pzHEJRNfq1DxNJ..WlAQx4wFr6kJesSGtKLv8/k/'\n- '!'\n- call-home\n- ' service active'\n- ' contact smart-licensing'\n- ' profile CiscoTAC-1'\n- '  active'\n- '  destination transport-method email disable'\n- '  destination transport-method http'\n- ' !'\n- '!'\n- ''\n- interface MgmtEth0/RP0/CPU0/0\n- ' no ipv4 address dhcp'\n- ' ipv4 address 192.168.18.3 255.255.255.0'\n- ' no shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/0\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/1\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/2\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/3\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/4\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/5\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/6\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/7\n- ' shutdown'\n- '!'\n- ''\n- ssh client source-interface MgmtEth0/RP0/CPU0/0\n- ssh server vrf default\n- ''\n- root\n- '!'\n- ''\n- ''\nok: [PE1] =&gt; msg:\n- 'template: restore_topology_template.j2'\n- - username cisco\n- ' group root-lr'\n- ' group cisco-support'\n- ' secret 10 $6$m69UO/m0cK.e3O/.$EtYXDVl3/aphJkazxKy145fyIY/./Xxt1fi7B3tjYemXr6pzHEJRNfq1DxNJ..WlAQx4wFr6kJesSGtKLv8/k/'\n- '!'\n- call-home\n- ' service active'\n- ' contact smart-licensing'\n- ' profile CiscoTAC-1'\n- '  active'\n- '  destination transport-method email disable'\n- '  destination transport-method http'\n- ' !'\n- '!'\n- ''\n- interface MgmtEth0/RP0/CPU0/0\n- ' no ipv4 address dhcp'\n- ' ipv4 address 192.168.18.1 255.255.255.0'\n- ' no shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/0\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/1\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/2\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/3\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/4\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/5\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/6\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/7\n- ' shutdown'\n- '!'\n- ''\n- ssh client source-interface MgmtEth0/RP0/CPU0/0\n- ssh server vrf default\n- ''\n- root\n- '!'\n- ''\n- ''\nok: [P4] =&gt; msg:\n- 'template: restore_topology_template.j2'\n- - username cisco\n- ' group root-lr'\n- ' group cisco-support'\n- ' secret 10 $6$m69UO/m0cK.e3O/.$EtYXDVl3/aphJkazxKy145fyIY/./Xxt1fi7B3tjYemXr6pzHEJRNfq1DxNJ..WlAQx4wFr6kJesSGtKLv8/k/'\n- '!'\n- call-home\n- ' service active'\n- ' contact smart-licensing'\n- ' profile CiscoTAC-1'\n- '  active'\n- '  destination transport-method email disable'\n- '  destination transport-method http'\n- ' !'\n- '!'\n- ''\n- interface MgmtEth0/RP0/CPU0/0\n- ' no ipv4 address dhcp'\n- ' ipv4 address 192.168.18.4 255.255.255.0'\n- ' no shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/0\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/1\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/2\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/3\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/4\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/5\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/6\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/7\n- ' shutdown'\n- '!'\n- ''\n- ssh client source-interface MgmtEth0/RP0/CPU0/0\n- ssh server vrf default\n- ''\n- root\n- '!'\n- ''\n- ''\nok: [P9] =&gt; msg:\n- 'template: restore_topology_template.j2'\n- - username cisco\n- ' group root-lr'\n- ' group cisco-support'\n- ' secret 10 $6$m69UO/m0cK.e3O/.$EtYXDVl3/aphJkazxKy145fyIY/./Xxt1fi7B3tjYemXr6pzHEJRNfq1DxNJ..WlAQx4wFr6kJesSGtKLv8/k/'\n- '!'\n- call-home\n- ' service active'\n- ' contact smart-licensing'\n- ' profile CiscoTAC-1'\n- '  active'\n- '  destination transport-method email disable'\n- '  destination transport-method http'\n- ' !'\n- '!'\n- ''\n- interface MgmtEth0/RP0/CPU0/0\n- ' no ipv4 address dhcp'\n- ' ipv4 address 192.168.18.9 255.255.255.0'\n- ' no shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/0\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/1\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/2\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/3\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/4\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/5\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/6\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/7\n- ' shutdown'\n- '!'\n- ''\n- ssh client source-interface MgmtEth0/RP0/CPU0/0\n- ssh server vrf default\n- ''\n- root\n- '!'\n- ''\n- ''\nok: [P7] =&gt; msg:\n- 'template: restore_topology_template.j2'\n- - username cisco\n- ' group root-lr'\n- ' group cisco-support'\n- ' secret 10 $6$m69UO/m0cK.e3O/.$EtYXDVl3/aphJkazxKy145fyIY/./Xxt1fi7B3tjYemXr6pzHEJRNfq1DxNJ..WlAQx4wFr6kJesSGtKLv8/k/'\n- '!'\n- call-home\n- ' service active'\n- ' contact smart-licensing'\n- ' profile CiscoTAC-1'\n- '  active'\n- '  destination transport-method email disable'\n- '  destination transport-method http'\n- ' !'\n- '!'\n- ''\n- interface MgmtEth0/RP0/CPU0/0\n- ' no ipv4 address dhcp'\n- ' ipv4 address 192.168.18.7 255.255.255.0'\n- ' no shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/0\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/1\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/2\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/3\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/4\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/5\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/6\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/7\n- ' shutdown'\n- '!'\n- ''\n- ssh client source-interface MgmtEth0/RP0/CPU0/0\n- ssh server vrf default\n- ''\n- root\n- '!'\n- ''\n- ''\nok: [P6] =&gt; msg:\n- 'template: restore_topology_template.j2'\n- - username cisco\n- ' group root-lr'\n- ' group cisco-support'\n- ' secret 10 $6$m69UO/m0cK.e3O/.$EtYXDVl3/aphJkazxKy145fyIY/./Xxt1fi7B3tjYemXr6pzHEJRNfq1DxNJ..WlAQx4wFr6kJesSGtKLv8/k/'\n- '!'\n- call-home\n- ' service active'\n- ' contact smart-licensing'\n- ' profile CiscoTAC-1'\n- '  active'\n- '  destination transport-method email disable'\n- '  destination transport-method http'\n- ' !'\n- '!'\n- ''\n- interface MgmtEth0/RP0/CPU0/0\n- ' no ipv4 address dhcp'\n- ' ipv4 address 192.168.18.6 255.255.255.0'\n- ' no shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/0\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/1\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/2\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/3\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/4\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/5\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/6\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/7\n- ' shutdown'\n- '!'\n- ''\n- ssh client source-interface MgmtEth0/RP0/CPU0/0\n- ssh server vrf default\n- ''\n- root\n- '!'\n- ''\n- ''\nok: [PE5] =&gt; msg:\n- 'template: restore_topology_template.j2'\n- - username cisco\n- ' group root-lr'\n- ' group cisco-support'\n- ' secret 10 $6$m69UO/m0cK.e3O/.$EtYXDVl3/aphJkazxKy145fyIY/./Xxt1fi7B3tjYemXr6pzHEJRNfq1DxNJ..WlAQx4wFr6kJesSGtKLv8/k/'\n- '!'\n- call-home\n- ' service active'\n- ' contact smart-licensing'\n- ' profile CiscoTAC-1'\n- '  active'\n- '  destination transport-method email disable'\n- '  destination transport-method http'\n- ' !'\n- '!'\n- ''\n- interface MgmtEth0/RP0/CPU0/0\n- ' no ipv4 address dhcp'\n- ' ipv4 address 192.168.18.5 255.255.255.0'\n- ' no shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/0\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/1\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/2\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/3\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/4\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/5\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/6\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/7\n- ' shutdown'\n- '!'\n- ''\n- ssh client source-interface MgmtEth0/RP0/CPU0/0\n- ssh server vrf default\n- ''\n- root\n- '!'\n- ''\n- ''\nok: [P8] =&gt; msg:\n- 'template: restore_topology_template.j2'\n- - username cisco\n- ' group root-lr'\n- ' group cisco-support'\n- ' secret 10 $6$m69UO/m0cK.e3O/.$EtYXDVl3/aphJkazxKy145fyIY/./Xxt1fi7B3tjYemXr6pzHEJRNfq1DxNJ..WlAQx4wFr6kJesSGtKLv8/k/'\n- '!'\n- call-home\n- ' service active'\n- ' contact smart-licensing'\n- ' profile CiscoTAC-1'\n- '  active'\n- '  destination transport-method email disable'\n- '  destination transport-method http'\n- ' !'\n- '!'\n- ''\n- interface MgmtEth0/RP0/CPU0/0\n- ' no ipv4 address dhcp'\n- ' ipv4 address 192.168.18.8 255.255.255.0'\n- ' no shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/0\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/1\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/2\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/3\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/4\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/5\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/6\n- ' shutdown'\n- '!'\n- interface GigabitEthernet0/0/0/7\n- ' shutdown'\n- '!'\n- ''\n- ssh client source-interface MgmtEth0/RP0/CPU0/0\n- ssh server vrf default\n- ''\n- root\n- '!'\n- ''\n- ''\nTASK [0.1 RENDER AND SAVE THE BASE CONFIGURATION] ******************************\nchanged: [P4]\nchanged: [P9]\nchanged: [P6]\nchanged: [PE1]\nchanged: [P3]\nchanged: [P8]\nchanged: [PE5]\nchanged: [P2]\nchanged: [P7]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [PE1]\nTASK [0.2 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [PE1] =&gt; output.dest: xrcfg/PE1.base.xrcfg\nok: [P3] =&gt; output.dest: xrcfg/P3.base.xrcfg\nok: [P6] =&gt; output.dest: xrcfg/P6.base.xrcfg\nok: [P4] =&gt; output.dest: xrcfg/P4.base.xrcfg\nok: [P7] =&gt; output.dest: xrcfg/P7.base.xrcfg\nok: [P2] =&gt; output.dest: xrcfg/P2.base.xrcfg\nok: [P8] =&gt; output.dest: xrcfg/P8.base.xrcfg\nok: [P9] =&gt; output.dest: xrcfg/P9.base.xrcfg\nok: [PE5] =&gt; output.dest: xrcfg/PE5.base.xrcfg\nTASK [0.3 RENDER AND APPLY THE BASE CONFIGURATION] *****************************\nchanged: [P9]\nchanged: [PE5]\nchanged: [P7]\nchanged: [P6]\nchanged: [P3]\nchanged: [PE1]\nchanged: [P4]\nchanged: [P8]\nchanged: [P2]\n</code></pre>"},{"location":"all_inclusive_play/#getting-started-with-ip-isis-and-ldp","title":"Getting Started with IP, ISIS and LDP","text":"Base Topology <pre><code>PLAY [1. CISCO XRV9K SR WITH TI-LFA LAB PLAYBOOK - GETTING STARTED] ************\nTASK [1.0 RENDER AND DISPLAY THE IP, ISIS &amp; LDP CONFIGURATION] *****************\nok: [P2] =&gt; msg:\n- 'template: ip_igp_ldp_template.j2'\n- - ''\n- hostname P2\n- root\n- ''\n- interface Loopback0\n- ' ipv4 address 2.2.2.2/32'\n- ' description System_Loopback_Interface'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/0\n- ' ipv4 address 23.0.0.2/24'\n- ' description P2_to_P3'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/1\n- ' ipv4 address 26.0.0.2/24'\n- ' description P2_to_P6'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/2\n- ' ipv4 address 12.0.0.2/24'\n- ' description P2_to_PE1'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/3\n- ' ipv4 address 27.0.0.2/24'\n- ' description P2_to_P7'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/5\n- ' ipv4 address 29.0.0.2/24'\n- ' description P2_to_P9'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- router isis IGP\n- ' is-type level-2-only'\n- ' net 49.0000.0000.0002.00'\n- ' log adjacency changes'\n- ' address-family ipv4 unicast'\n- '  mpls ldp auto-config'\n- '  metric-style wide level 2'\n- ' !'\n- ' interface Loopback0'\n- '  passive'\n- '  address-family ipv4 unicast'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/0'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/1'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/2'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/3'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/5'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  !'\n- root\n- ''\n- mpls oam\n- '!'\n- mpls ldp\n- ' log'\n- '  neighbor'\n- ' !'\n- '!'\n- root\n- '!'\n- ''\n- ''\nok: [P3] =&gt; msg:\n- 'template: ip_igp_ldp_template.j2'\n- - ''\n- hostname P3\n- root\n- ''\n- interface Loopback0\n- ' ipv4 address 3.3.3.3/32'\n- ' description System_Loopback_Interface'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/0\n- ' ipv4 address 23.0.0.3/24'\n- ' description P3_to_P2'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/1\n- ' ipv4 address 37.0.0.3/24'\n- ' description P3_to_P7'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/2\n- ' ipv4 address 34.0.0.3/24'\n- ' description P3_to_P4'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/3\n- ' ipv4 address 39.0.0.3/24'\n- ' description P3_to_P9'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- router isis IGP\n- ' is-type level-2-only'\n- ' net 49.0000.0000.0003.00'\n- ' log adjacency changes'\n- ' address-family ipv4 unicast'\n- '  mpls ldp auto-config'\n- '  metric-style wide level 2'\n- ' !'\n- ' interface Loopback0'\n- '  passive'\n- '  address-family ipv4 unicast'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/0'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/1'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/2'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/3'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  !'\n- root\n- ''\n- mpls oam\n- '!'\n- mpls ldp\n- ' log'\n- '  neighbor'\n- ' !'\n- '!'\n- root\n- '!'\n- ''\n- ''\nok: [PE1] =&gt; msg:\n- 'template: ip_igp_ldp_template.j2'\n- - ''\n- hostname PE1\n- root\n- ''\n- interface Loopback0\n- ' ipv4 address 1.1.1.1/32'\n- ' description System_Loopback_Interface'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/2\n- ' ipv4 address 12.0.0.1/24'\n- ' description PE1_to_P2'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- router isis IGP\n- ' is-type level-2-only'\n- ' net 49.0000.0000.0001.00'\n- ' log adjacency changes'\n- ' address-family ipv4 unicast'\n- '  mpls ldp auto-config'\n- '  metric-style wide level 2'\n- ' !'\n- ' interface Loopback0'\n- '  passive'\n- '  address-family ipv4 unicast'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/2'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  !'\n- root\n- ''\n- mpls oam\n- '!'\n- mpls ldp\n- ' log'\n- '  neighbor'\n- ' !'\n- '!'\n- root\n- '!'\n- ''\n- ''\nok: [P6] =&gt; msg:\n- 'template: ip_igp_ldp_template.j2'\n- - ''\n- hostname P6\n- root\n- ''\n- interface Loopback0\n- ' ipv4 address 6.6.6.6/32'\n- ' description System_Loopback_Interface'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/0\n- ' ipv4 address 67.0.0.6/24'\n- ' description P6_to_P7'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/1\n- ' ipv4 address 26.0.0.6/24'\n- ' description P6_to_P2'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- router isis IGP\n- ' is-type level-2-only'\n- ' net 49.0000.0000.0006.00'\n- ' log adjacency changes'\n- ' address-family ipv4 unicast'\n- '  mpls ldp auto-config'\n- '  metric-style wide level 2'\n- ' !'\n- ' interface Loopback0'\n- '  passive'\n- '  address-family ipv4 unicast'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/0'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/1'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  !'\n- root\n- ''\n- mpls oam\n- '!'\n- mpls ldp\n- ' log'\n- '  neighbor'\n- ' !'\n- '!'\n- root\n- '!'\n- ''\n- ''\nok: [PE5] =&gt; msg:\n- 'template: ip_igp_ldp_template.j2'\n- - ''\n- hostname PE5\n- root\n- ''\n- interface Loopback0\n- ' ipv4 address 5.5.5.5/32'\n- ' description System_Loopback_Interface'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/0\n- ' ipv4 address 45.0.0.5/24'\n- ' description PE5_to_P4'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- router isis IGP\n- ' is-type level-2-only'\n- ' net 49.0000.0000.0005.00'\n- ' log adjacency changes'\n- ' address-family ipv4 unicast'\n- '  mpls ldp auto-config'\n- '  metric-style wide level 2'\n- ' !'\n- ' interface Loopback0'\n- '  passive'\n- '  address-family ipv4 unicast'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/0'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  !'\n- root\n- ''\n- mpls oam\n- '!'\n- mpls ldp\n- ' log'\n- '  neighbor'\n- ' !'\n- '!'\n- root\n- '!'\n- ''\n- ''\nok: [P8] =&gt; msg:\n- 'template: ip_igp_ldp_template.j2'\n- - ''\n- hostname P8\n- root\n- ''\n- interface Loopback0\n- ' ipv4 address 8.8.8.8/32'\n- ' description System_Loopback_Interface'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/1\n- ' ipv4 address 48.0.0.8/24'\n- ' description P8_to_P4'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/2\n- ' ipv4 address 78.0.0.8/24'\n- ' description P8_to_P7'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- router isis IGP\n- ' is-type level-2-only'\n- ' net 49.0000.0000.0008.00'\n- ' log adjacency changes'\n- ' address-family ipv4 unicast'\n- '  mpls ldp auto-config'\n- '  metric-style wide level 2'\n- ' !'\n- ' interface Loopback0'\n- '  passive'\n- '  address-family ipv4 unicast'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/0'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/1'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/2'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  !'\n- root\n- ''\n- mpls oam\n- '!'\n- mpls ldp\n- ' log'\n- '  neighbor'\n- ' !'\n- '!'\n- root\n- '!'\n- ''\n- ''\nok: [P4] =&gt; msg:\n- 'template: ip_igp_ldp_template.j2'\n- - ''\n- hostname P4\n- root\n- ''\n- interface Loopback0\n- ' ipv4 address 4.4.4.4/32'\n- ' description System_Loopback_Interface'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/0\n- ' ipv4 address 45.0.0.4/24'\n- ' description P4_to_PE5'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/1\n- ' ipv4 address 48.0.0.4/24'\n- ' description P4_to_P8'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/2\n- ' ipv4 address 34.0.0.4/24'\n- ' description P4_to_P3'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/4\n- ' ipv4 address 47.0.0.4/24'\n- ' description P4_to_P7'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- router isis IGP\n- ' is-type level-2-only'\n- ' net 49.0000.0000.0004.00'\n- ' log adjacency changes'\n- ' address-family ipv4 unicast'\n- '  mpls ldp auto-config'\n- '  metric-style wide level 2'\n- ' !'\n- ' interface Loopback0'\n- '  passive'\n- '  address-family ipv4 unicast'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/0'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/1'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/2'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/4'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  !'\n- root\n- ''\n- mpls oam\n- '!'\n- mpls ldp\n- ' log'\n- '  neighbor'\n- ' !'\n- '!'\n- root\n- '!'\n- ''\n- ''\nok: [P7] =&gt; msg:\n- 'template: ip_igp_ldp_template.j2'\n- - ''\n- hostname P7\n- root\n- ''\n- interface Loopback0\n- ' ipv4 address 7.7.7.7/32'\n- ' description System_Loopback_Interface'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/0\n- ' ipv4 address 67.0.0.7/24'\n- ' description P7_to_P6'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/1\n- ' ipv4 address 37.0.0.7/24'\n- ' description P7_to_P7'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/2\n- ' ipv4 address 78.0.0.7/24'\n- ' description P7_to_P8'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/3\n- ' ipv4 address 27.0.0.7/24'\n- ' description P7_to_P2'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/4\n- ' ipv4 address 47.0.0.7/24'\n- ' description P7_to_P4'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- router isis IGP\n- ' is-type level-2-only'\n- ' net 49.0000.0000.0007.00'\n- ' log adjacency changes'\n- ' address-family ipv4 unicast'\n- '  mpls ldp auto-config'\n- '  metric-style wide level 2'\n- ' !'\n- ' interface Loopback0'\n- '  passive'\n- '  address-family ipv4 unicast'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/0'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/1'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/2'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/3'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/4'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  !'\n- root\n- ''\n- mpls oam\n- '!'\n- mpls ldp\n- ' log'\n- '  neighbor'\n- ' !'\n- '!'\n- root\n- '!'\n- ''\n- ''\nTASK [1.1 RENDER AND SAVE THE IP, ISIS &amp; LDP CONFIGURATION] ********************\nchanged: [PE1]\nchanged: [P3]\nchanged: [P2]\nchanged: [PE5]\nchanged: [P6]\nchanged: [P8]\nchanged: [P4]\nchanged: [P7]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [PE1]\nTASK [1.2 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [PE1] =&gt; output.dest: xrcfg/PE1.ip_mpls.xrcfg\nok: [PE5] =&gt; output.dest: xrcfg/PE5.ip_mpls.xrcfg\nok: [P2] =&gt; output.dest: xrcfg/P2.ip_mpls.xrcfg\nok: [P6] =&gt; output.dest: xrcfg/P6.ip_mpls.xrcfg\nok: [P4] =&gt; output.dest: xrcfg/P4.ip_mpls.xrcfg\nok: [P7] =&gt; output.dest: xrcfg/P7.ip_mpls.xrcfg\nok: [P3] =&gt; output.dest: xrcfg/P3.ip_mpls.xrcfg\nok: [P8] =&gt; output.dest: xrcfg/P8.ip_mpls.xrcfg\nTASK [1.3 RENDER AND APPLY THE IP, ISIS &amp; LDP CONFIGURATION] *******************\nchanged: [PE1]\nchanged: [PE5]\nchanged: [P6]\nchanged: [P8]\nchanged: [P3]\nchanged: [P4]\nchanged: [P2]\nchanged: [P7]\nPausing for 120 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [2 mins PAUSE FOR CONVERGENCE] ********************************************\nok: [PE1]\nTASK [1.4 RUN COMMANDS TO CAPTURE IP, ISIS &amp; LDP STATE] ************************\nok: [PE1] =&gt; (item=show ipv4 interface brief)\nok: [PE1] =&gt; (item=ping 12.0.0.2)\nok: [PE1] =&gt; (item=show isis adjacency)\nok: [PE1] =&gt; (item=show route)\nok: [PE1] =&gt; (item=show isis route 5.5.5.5/32 detail)\nok: [PE1] =&gt; (item=show route 5.5.5.5/32 detail)\nok: [PE1] =&gt; (item=show mpls ldp neighbor brief)\nok: [PE1] =&gt; (item=show mpls label table)\nok: [PE1] =&gt; (item=show mpls forwarding)\nok: [PE1] =&gt; (item=show cef 5.5.5.5/32)\nok: [PE1] =&gt; (item=traceroute mpls ipv4 5.5.5.5/32)\nok: [PE1] =&gt; (item=traceroute mpls multipath ipv4 5.5.5.5/32 verbose)\nTASK [1.5 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [PE1] =&gt; (item=show ipv4 interface brief) =&gt; msg:\n- - - Interface                      IP-Address      Status          Protocol Vrf-Name\n- 'Loopback0                      1.1.1.1         Up              Up       default '\n- 'MgmtEth0/RP0/CPU0/0            192.168.18.1    Up              Up       default '\n- 'GigabitEthernet0/0/0/0         unassigned      Shutdown        Down     default '\n- 'GigabitEthernet0/0/0/1         unassigned      Shutdown        Down     default '\n- 'GigabitEthernet0/0/0/2         12.0.0.1        Up              Up       default '\n- 'GigabitEthernet0/0/0/3         unassigned      Shutdown        Down     default '\n- 'GigabitEthernet0/0/0/4         unassigned      Shutdown        Down     default '\n- 'GigabitEthernet0/0/0/5         unassigned      Shutdown        Down     default '\n- 'GigabitEthernet0/0/0/6         unassigned      Shutdown        Down     default '\n- GigabitEthernet0/0/0/7         unassigned      Shutdown        Down     default\nok: [PE1] =&gt; (item=ping 12.0.0.2) =&gt; msg:\n- - - Type escape sequence to abort.\n- 'Sending 5, 100-byte ICMP Echos to 12.0.0.2, timeout is 2 seconds:'\n- '!!!!!'\n- Success rate is 100 percent (5/5), round-trip min/avg/max = 2/3/11 ms\nok: [PE1] =&gt; (item=show isis adjacency) =&gt; msg:\n- - - 'IS-IS IGP Level-2 adjacencies:'\n- System Id      Interface                SNPA           State Hold Changed  NSF IPv4 IPv6\n- '                                                                               BFD  BFD '\n- P2             Gi0/0/0/2                *PtoP*         Up    23   00:02:06 Yes None None\n- ''\n- 'Total adjacency count: 1'\nok: [PE1] =&gt; (item=show route) =&gt; msg:\n- - - 'Codes: C - connected, S - static, R - RIP, B - BGP, (&gt;) - Diversion path'\n- '       D - EIGRP, EX - EIGRP external, O - OSPF, IA - OSPF inter area'\n- '       N1 - OSPF NSSA external type 1, N2 - OSPF NSSA external type 2'\n- '       E1 - OSPF external type 1, E2 - OSPF external type 2, E - EGP'\n- '       i - ISIS, L1 - IS-IS level-1, L2 - IS-IS level-2'\n- '       ia - IS-IS inter area, su - IS-IS summary null, * - candidate default'\n- '       U - per-user static route, o - ODR, L - local, G  - DAGR, l - LISP'\n- '       A - access/subscriber, a - Application route'\n- '       M - mobile route, r - RPL, t - Traffic Engineering, (!) - FRR Backup path'\n- ''\n- Gateway of last resort is not set\n- ''\n- L    1.1.1.1/32 is directly connected, 00:02:12, Loopback0\n- i L2 2.2.2.2/32 [115/10] via 12.0.0.2, 00:01:56, GigabitEthernet0/0/0/2\n- i L2 3.3.3.3/32 [115/20] via 12.0.0.2, 00:01:42, GigabitEthernet0/0/0/2\n- i L2 4.4.4.4/32 [115/30] via 12.0.0.2, 00:01:42, GigabitEthernet0/0/0/2\n- i L2 5.5.5.5/32 [115/40] via 12.0.0.2, 00:01:42, GigabitEthernet0/0/0/2\n- i L2 6.6.6.6/32 [115/20] via 12.0.0.2, 00:01:42, GigabitEthernet0/0/0/2\n- i L2 7.7.7.7/32 [115/20] via 12.0.0.2, 00:01:42, GigabitEthernet0/0/0/2\n- i L2 8.8.8.8/32 [115/30] via 12.0.0.2, 00:01:42, GigabitEthernet0/0/0/2\n- C    12.0.0.0/24 is directly connected, 00:02:12, GigabitEthernet0/0/0/2\n- L    12.0.0.1/32 is directly connected, 00:02:12, GigabitEthernet0/0/0/2\n- i L2 23.0.0.0/24 [115/20] via 12.0.0.2, 00:01:56, GigabitEthernet0/0/0/2\n- i L2 26.0.0.0/24 [115/20] via 12.0.0.2, 00:01:56, GigabitEthernet0/0/0/2\n- i L2 27.0.0.0/24 [115/20] via 12.0.0.2, 00:01:56, GigabitEthernet0/0/0/2\n- i L2 29.0.0.0/24 [115/20] via 12.0.0.2, 00:01:56, GigabitEthernet0/0/0/2\n- i L2 34.0.0.0/24 [115/30] via 12.0.0.2, 00:01:42, GigabitEthernet0/0/0/2\n- i L2 37.0.0.0/24 [115/30] via 12.0.0.2, 00:01:42, GigabitEthernet0/0/0/2\n- i L2 39.0.0.0/24 [115/30] via 12.0.0.2, 00:01:42, GigabitEthernet0/0/0/2\n- i L2 45.0.0.0/24 [115/40] via 12.0.0.2, 00:01:42, GigabitEthernet0/0/0/2\n- i L2 47.0.0.0/24 [115/30] via 12.0.0.2, 00:01:42, GigabitEthernet0/0/0/2\n- i L2 48.0.0.0/24 [115/40] via 12.0.0.2, 00:01:42, GigabitEthernet0/0/0/2\n- i L2 67.0.0.0/24 [115/30] via 12.0.0.2, 00:01:42, GigabitEthernet0/0/0/2\n- i L2 78.0.0.0/24 [115/30] via 12.0.0.2, 00:01:42, GigabitEthernet0/0/0/2\n- L    127.0.0.0/8 [0/0] via 0.0.0.0, 00:02:13\n- C    192.168.18.0/24 is directly connected, 03:46:39, MgmtEth0/RP0/CPU0/0\n- L    192.168.18.1/32 is directly connected, 03:46:39, MgmtEth0/RP0/CPU0/0\nok: [PE1] =&gt; (item=show isis route 5.5.5.5/32 detail) =&gt; msg:\n- - - 'L2 5.5.5.5/32 [40/115] Label: None, medium priority'\n- '   Installed Mar 05 13:17:05.656 for 00:01:43'\n- '     via 12.0.0.2, GigabitEthernet0/0/0/2, P2, Weight: 0'\n- '     src PE5.00-00, 5.5.5.5'\nok: [PE1] =&gt; (item=show route 5.5.5.5/32 detail) =&gt; msg:\n- - - Routing entry for 5.5.5.5/32\n- '  Known via \"isis IGP\", distance 115, metric 40, type level-2'\n- '  Installed Mar  5 13:17:05.657 for 00:01:43'\n- '  Routing Descriptor Blocks'\n- '    12.0.0.2, from 5.5.5.5, via GigabitEthernet0/0/0/2'\n- '      Route metric is 40'\n- '      Label: None'\n- '      Tunnel ID: None'\n- '      Binding Label: None'\n- '      Extended communities count: 0'\n- \"      Path id:1\\t      Path ref count:0\"\n- '      NHID:0x2(Ref:20)'\n- '  Route version is 0x1 (1)'\n- '  No local label'\n- '  IP Precedence: Not Set'\n- '  QoS Group ID: Not Set'\n- '  Flow-tag: Not Set'\n- '  Fwd-class: Not Set'\n- '  Route Priority: RIB_PRIORITY_NON_RECURSIVE_MEDIUM (7) SVD Type RIB_SVD_TYPE_LOCAL'\n- '  Download Priority 1, Download Version 2183'\n- '  No advertising protos.'\nok: [PE1] =&gt; (item=show mpls ldp neighbor brief) =&gt; msg:\n- - - 'Peer               GR  NSR  Up Time     Discovery   Addresses     Labels    '\n- '                                        ipv4  ipv6  ipv4  ipv6  ipv4   ipv6 '\n- '-----------------  --  ---  ----------  ----------  ----------  ------------'\n- 2.2.2.2:0          N   N    00:01:31    1     0     7     0     22     0\nok: [PE1] =&gt; (item=show mpls label table) =&gt; msg:\n- - - Table Label   Owner                           State  Rewrite\n- '----- ------- ------------------------------- ------ -------'\n- 0     0       LSD(A)                          InUse  Yes\n- 0     1       LSD(A)                          InUse  Yes\n- 0     2       LSD(A)                          InUse  Yes\n- 0     13      LSD(A)                          InUse  Yes\n- 0     24000   LDP(A)                          InUse  Yes\n- 0     24001   LDP(A)                          InUse  Yes\n- 0     24002   LDP(A)                          InUse  Yes\n- 0     24003   LDP(A)                          InUse  Yes\n- 0     24004   LDP(A)                          InUse  Yes\n- 0     24006   LDP(A)                          InUse  Yes\n- 0     24007   LDP(A)                          InUse  Yes\n- 0     24008   LDP(A)                          InUse  Yes\n- 0     24009   LDP(A)                          InUse  Yes\n- 0     24010   LDP(A)                          InUse  Yes\n- 0     24011   LDP(A)                          InUse  Yes\n- 0     24012   LDP(A)                          InUse  Yes\n- 0     24013   LDP(A)                          InUse  Yes\n- 0     24014   LDP(A)                          InUse  Yes\n- 0     24015   LDP(A)                          InUse  Yes\n- 0     24016   LDP(A)                          InUse  Yes\n- 0     24017   LDP(A)                          InUse  Yes\n- 0     24018   LDP(A)                          InUse  Yes\n- 0     24022   LDP(A)                          InUse  Yes\nok: [PE1] =&gt; (item=show mpls forwarding) =&gt; msg:\n- - - 'Local  Outgoing    Prefix             Outgoing     Next Hop        Bytes       '\n- 'Label  Label       or ID              Interface                    Switched    '\n- '------ ----------- ------------------ ------------ --------------- ------------'\n- '24000  Pop         2.2.2.2/32         Gi0/0/0/2    12.0.0.2        138         '\n- '24001  24001       3.3.3.3/32         Gi0/0/0/2    12.0.0.2        0           '\n- '24002  24002       6.6.6.6/32         Gi0/0/0/2    12.0.0.2        0           '\n- '24003  24003       7.7.7.7/32         Gi0/0/0/2    12.0.0.2        0           '\n- '24004  24004       4.4.4.4/32         Gi0/0/0/2    12.0.0.2        0           '\n- '24006  24006       5.5.5.5/32         Gi0/0/0/2    12.0.0.2        0           '\n- '24007  Pop         29.0.0.0/24        Gi0/0/0/2    12.0.0.2        0           '\n- '24008  24007       39.0.0.0/24        Gi0/0/0/2    12.0.0.2        0           '\n- '24009  Pop         23.0.0.0/24        Gi0/0/0/2    12.0.0.2        847         '\n- '24010  Pop         26.0.0.0/24        Gi0/0/0/2    12.0.0.2        0           '\n- '24011  24008       67.0.0.0/24        Gi0/0/0/2    12.0.0.2        0           '\n- '24012  24009       37.0.0.0/24        Gi0/0/0/2    12.0.0.2        0           '\n- '24013  Pop         27.0.0.0/24        Gi0/0/0/2    12.0.0.2        0           '\n- '24014  24010       47.0.0.0/24        Gi0/0/0/2    12.0.0.2        0           '\n- '24015  24011       34.0.0.0/24        Gi0/0/0/2    12.0.0.2        0           '\n- '24016  24012       78.0.0.0/24        Gi0/0/0/2    12.0.0.2        0           '\n- '24017  24013       48.0.0.0/24        Gi0/0/0/2    12.0.0.2        0           '\n- '24018  24014       45.0.0.0/24        Gi0/0/0/2    12.0.0.2        0           '\n- 24022  24030       8.8.8.8/32         Gi0/0/0/2    12.0.0.2        0\nok: [PE1] =&gt; (item=show cef 5.5.5.5/32) =&gt; msg:\n- - - 5.5.5.5/32, version 1470, internal 0x1000001 0x30 (ptr 0xe831de0) [1], 0x600 (0xe1a0578), 0xa28 (0xebfe9b8)\n- ' Updated Mar  5 13:17:18.750 '\n- ' remote adjacency to GigabitEthernet0/0/0/2'\n- ' Prefix Len 32, traffic index 0, precedence n/a, priority 3'\n- '  gateway array (0xe007da8) reference count 42, flags 0x68, source lsd (5), 1 backups'\n- '                [15 type 5 flags 0x8401 (0xec41528) ext 0x0 (0x0)]'\n- '  LW-LDI[type=5, refc=3, ptr=0xe1a0578, sh-ldi=0xec41528]'\n- '  gateway array update type-time 1 Mar  5 13:17:18.749'\n- ' LDI Update time Mar  5 13:17:18.749'\n- ' LW-LDI-TS Mar  5 13:17:18.750'\n- '   via 12.0.0.2/32, GigabitEthernet0/0/0/2, 4 dependencies, weight 0, class 0 [flags 0x0]'\n- '    path-idx 0 NHID 0x0 [0xf3a8790 0x0]'\n- '    next hop 12.0.0.2/32'\n- '    remote adjacency'\n- '     local label 24006      labels imposed {24006}'\n- ''\n- '    Load distribution: 0 (refcount 15)'\n- ''\n- '    Hash  OK  Interface                 Address'\n- '    0     Y   GigabitEthernet0/0/0/2    remote'\nok: [PE1] =&gt; (item=traceroute mpls ipv4 5.5.5.5/32) =&gt; msg:\n- - - Tracing MPLS Label Switched Path to 5.5.5.5/32, timeout is 2 seconds\n- ''\n- 'Codes: ''!'' - success, ''Q'' - request not sent, ''.'' - timeout,'\n- '  ''L'' - labeled output interface, ''B'' - unlabeled output interface, '\n- '  ''D'' - DS Map mismatch, ''F'' - no FEC mapping, ''f'' - FEC mismatch,'\n- '  ''M'' - malformed request, ''m'' - unsupported tlvs, ''N'' - no rx label, '\n- '  ''P'' - no rx intf label prot, ''p'' - premature termination of LSP, '\n- '  ''R'' - transit router, ''I'' - unknown upstream index,'\n- '  ''X'' - unknown return code, ''x'' - return code 0'\n- ''\n- Type escape sequence to abort.\n- ''\n- '  0 12.0.0.1 MRU 1500 [Labels: 24006 Exp: 0]'\n- 'L 1 12.0.0.2 MRU 1500 [Labels: 24009 Exp: 0] 19 ms'\n- 'L 2 27.0.0.7 MRU 1500 [Labels: 24001 Exp: 0] 13 ms'\n- 'L 3 47.0.0.4 MRU 1500 [Labels: implicit-null Exp: 0] 15 ms'\n- '! 4 45.0.0.5 13 ms'\nok: [PE1] =&gt; (item=traceroute mpls multipath ipv4 5.5.5.5/32 verbose) =&gt; msg:\n- - - Starting LSP Path Discovery for 5.5.5.5/32\n- ''\n- 'Codes: ''!'' - success, ''Q'' - request not sent, ''.'' - timeout,'\n- '  ''L'' - labeled output interface, ''B'' - unlabeled output interface, '\n- '  ''D'' - DS Map mismatch, ''F'' - no FEC mapping, ''f'' - FEC mismatch,'\n- '  ''M'' - malformed request, ''m'' - unsupported tlvs, ''N'' - no rx label, '\n- '  ''P'' - no rx intf label prot, ''p'' - premature termination of LSP, '\n- '  ''R'' - transit router, ''I'' - unknown upstream index,'\n- '  ''X'' - unknown return code, ''x'' - return code 0'\n- ''\n- Type escape sequence to abort.\n- ''\n- LLL!\n- 'Path 0 found, '\n- ' output interface GigabitEthernet0/0/0/2 nexthop 12.0.0.2'\n- ' source 12.0.0.1 destination 127.0.0.3'\n- '  0 12.0.0.1 12.0.0.2 MRU 1500 [Labels: 24006 Exp: 0] multipaths 0'\n- 'L 1 12.0.0.2 23.0.0.3 MRU 1500 [Labels: 24010 Exp: 0] ret code 8 multipaths 2'\n- 'L 2 23.0.0.3 34.0.0.4 MRU 1500 [Labels: 24001 Exp: 0] ret code 8 multipaths 1'\n- 'L 3 34.0.0.4 45.0.0.5 MRU 1500 [Labels: implicit-null Exp: 0] ret code 8 multipaths 1'\n- '! 4 45.0.0.5, ret code 3 multipaths 0'\n- LL!\n- 'Path 1 found, '\n- ' output interface GigabitEthernet0/0/0/2 nexthop 12.0.0.2'\n- ' source 12.0.0.1 destination 127.0.0.0'\n- '  0 12.0.0.1 12.0.0.2 MRU 1500 [Labels: 24006 Exp: 0] multipaths 0'\n- 'L 1 12.0.0.2 27.0.0.7 MRU 1500 [Labels: 24009 Exp: 0] ret code 8 multipaths 2'\n- 'L 2 27.0.0.7 47.0.0.4 MRU 1500 [Labels: 24001 Exp: 0] ret code 8 multipaths 1'\n- 'L 3 47.0.0.4 45.0.0.5 MRU 1500 [Labels: implicit-null Exp: 0] ret code 8 multipaths 1'\n- '! 4 45.0.0.5, ret code 3 multipaths 0'\n- ''\n- Paths (found/broken/unexplored) (2/0/0)\n- ' Echo Request (sent/fail) (7/0)'\n- ' Echo Reply (received/timeout) (7/0)'\n- ' Total Time Elapsed 61 ms'\nTASK [1.6 RUN COMMANDS TO TRACE LABELS FROM PE1 TO PE5] ************************\nok: [PE1]\nok: [P4]\nok: [P3]\nok: [P2]\nok: [P7]\nPLAY [1.x CISCO XRV9K SR WITH TI-LFA LAB PLAYBOOK - GETTING STARTED] ***********\nTASK [DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] **********************\nok: [PE1] =&gt; msg:\n- show mpls forwarding prefix 5.5.5.5/32\n- - 'Local  Outgoing    Prefix             Outgoing     Next Hop        Bytes       '\n- 'Label  Label       or ID              Interface                    Switched    '\n- '------ ----------- ------------------ ------------ --------------- ------------'\n- 24006  24006       5.5.5.5/32         Gi0/0/0/2    12.0.0.2        0\nPLAY [1.x CISCO XRV9K SR WITH TI-LFA LAB PLAYBOOK - GETTING STARTED] ***********\nok: [P2] =&gt; msg:\n- show mpls forwarding prefix 5.5.5.5/32\n- - 'Local  Outgoing    Prefix             Outgoing     Next Hop        Bytes       '\n- 'Label  Label       or ID              Interface                    Switched    '\n- '------ ----------- ------------------ ------------ --------------- ------------'\n- '24006  24010       5.5.5.5/32         Gi0/0/0/0    23.0.0.3        384         '\n- '       24009       5.5.5.5/32         Gi0/0/0/3    27.0.0.7        744'\nPLAY [1.x CISCO XRV9K SR WITH TI-LFA LAB PLAYBOOK - GETTING STARTED] ***********\nok: [P3] =&gt; msg:\n- show mpls forwarding prefix 5.5.5.5/32\n- - 'Local  Outgoing    Prefix             Outgoing     Next Hop        Bytes       '\n- 'Label  Label       or ID              Interface                    Switched    '\n- '------ ----------- ------------------ ------------ --------------- ------------'\n- 24010  24001       5.5.5.5/32         Gi0/0/0/2    34.0.0.4        256\nPLAY [1.x CISCO XRV9K SR WITH TI-LFA LAB PLAYBOOK - GETTING STARTED] ***********\nok: [P7] =&gt; msg:\n- show mpls forwarding prefix 5.5.5.5/32\n- - 'Local  Outgoing    Prefix             Outgoing     Next Hop        Bytes       '\n- 'Label  Label       or ID              Interface                    Switched    '\n- '------ ----------- ------------------ ------------ --------------- ------------'\n- 24009  24001       5.5.5.5/32         Gi0/0/0/4    47.0.0.4        496\nPLAY [1.x CISCO XRV9K SR WITH TI-LFA LAB PLAYBOOK - GETTING STARTED] ***********\nok: [P4] =&gt; msg:\n- show mpls forwarding prefix 5.5.5.5/32\n- - 'Local  Outgoing    Prefix             Outgoing     Next Hop        Bytes       '\n- 'Label  Label       or ID              Interface                    Switched    '\n- '------ ----------- ------------------ ------------ --------------- ------------'\n- 24001  Pop         5.5.5.5/32         Gi0/0/0/0    45.0.0.5        382\n</code></pre>"},{"location":"all_inclusive_play/#introducing-segment-routing-sr","title":"Introducing Segment Routing (SR)","text":"Segment Routing + LDP <pre><code>PLAY [2. CISCO XRV9K SR WITH TI-LFA LAB PLAYBOOK - INTRODUCE SEGMENT ROUTING] ***\nTASK [2.0 RENDER AND DISPLAY SEGMENT ROUTING CONFIGURATION] ********************\nok: [PE1] =&gt; msg:\n- 'template: sr_template.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  segment-routing mpls'\n- ' !'\n- ' interface Loopback0'\n- '  address-family ipv4 unicast'\n- '   prefix-sid index 1'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P2] =&gt; msg:\n- 'template: sr_template.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  segment-routing mpls'\n- ' !'\n- ' interface Loopback0'\n- '  address-family ipv4 unicast'\n- '   prefix-sid index 2'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P3] =&gt; msg:\n- 'template: sr_template.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  segment-routing mpls'\n- ' !'\n- ' interface Loopback0'\n- '  address-family ipv4 unicast'\n- '   prefix-sid index 3'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P7] =&gt; msg:\n- 'template: sr_template.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  segment-routing mpls'\n- ' !'\n- ' interface Loopback0'\n- '  address-family ipv4 unicast'\n- '   prefix-sid index 7'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P6] =&gt; msg:\n- 'template: sr_template.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  segment-routing mpls'\n- ' !'\n- ' interface Loopback0'\n- '  address-family ipv4 unicast'\n- '   prefix-sid index 6'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nTASK [2.1 RENDER AND SAVE THE SEGMENT ROUTING CONFIGURATION] *******************\nchanged: [PE1]\nchanged: [P6]\nchanged: [P7]\nchanged: [P3]\nchanged: [P2]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [PE1]\nTASK [2.2 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [PE1] =&gt; output.dest: xrcfg/PE1.sr.xrcfg\nok: [P3] =&gt; output.dest: xrcfg/P3.sr.xrcfg\nok: [P6] =&gt; output.dest: xrcfg/P6.sr.xrcfg\nok: [P2] =&gt; output.dest: xrcfg/P2.sr.xrcfg\nok: [P7] =&gt; output.dest: xrcfg/P7.sr.xrcfg\nTASK [2.3 RENDER AND APPLY THE SEGMENT ROUTING CONFIGURATION] ******************\nchanged: [P3]\nchanged: [PE1]\nchanged: [P6]\nchanged: [P7]\nchanged: [P2]\nPausing for 60 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 minutes PAUSE FOR CONVERGENCE] *****************************************\nok: [PE1]\nTASK [2.4 RUN COMMANDS TO VERIFY SR AND LDP STATE] *****************************\nok: [PE1] =&gt; (item=show mpls label table detail)\nok: [PE1] =&gt; (item=show isis adjacency detail)\nok: [PE1] =&gt; (item=show isis database verbose PE1)\nok: [PE1] =&gt; (item=show isis segment-routing label table)\nok: [PE1] =&gt; (item=show route 7.7.7.7/32 detail)\nok: [PE1] =&gt; (item=show mpls forwarding)\nok: [PE1] =&gt; (item=show cef 7.7.7.7/32)\nok: [PE1] =&gt; (item=traceroute mpls ipv4 7.7.7.7/32)\nok: [PE1] =&gt; (item=traceroute sr-mpls 7.7.7.7/32)\nTASK [2.5 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [PE1] =&gt; (item=show mpls label table detail) =&gt; msg:\n- - - Table Label   Owner                           State  Rewrite\n- '----- ------- ------------------------------- ------ -------'\n- 0     0       LSD(A)                          InUse  Yes\n- 0     1       LSD(A)                          InUse  Yes\n- 0     2       LSD(A)                          InUse  Yes\n- 0     13      LSD(A)                          InUse  Yes\n- 0     16000   ISIS(A):IGP                     InUse  No\n- '  (Lbl-blk SRGB, vers:0, (start_label=16000, size=8000)'\n- 0     24000   LDP(A)                          InUse  Yes\n- '  (IPv4, vers:0, ''default'':4U, 2.2.2.2/32)'\n- 0     24001   LDP(A)                          InUse  Yes\n- '  (IPv4, vers:0, ''default'':4U, 3.3.3.3/32)'\n- 0     24002   LDP(A)                          InUse  Yes\n- '  (IPv4, vers:0, ''default'':4U, 6.6.6.6/32)'\n- 0     24003   LDP(A)                          InUse  Yes\n- '  (IPv4, vers:0, ''default'':4U, 7.7.7.7/32)'\n- 0     24004   LDP(A)                          InUse  Yes\n- '  (IPv4, vers:0, ''default'':4U, 4.4.4.4/32)'\n- 0     24006   LDP(A)                          InUse  Yes\n- '  (IPv4, vers:0, ''default'':4U, 5.5.5.5/32)'\n- 0     24007   LDP(A)                          InUse  Yes\n- '  (IPv4, vers:0, ''default'':4U, 29.0.0.0/24)'\n- 0     24008   LDP(A)                          InUse  Yes\n- '  (IPv4, vers:0, ''default'':4U, 39.0.0.0/24)'\n- 0     24009   LDP(A)                          InUse  Yes\n- '  (IPv4, vers:0, ''default'':4U, 23.0.0.0/24)'\n- 0     24010   LDP(A)                          InUse  Yes\n- '  (IPv4, vers:0, ''default'':4U, 26.0.0.0/24)'\n- 0     24011   LDP(A)                          InUse  Yes\n- '  (IPv4, vers:0, ''default'':4U, 67.0.0.0/24)'\n- 0     24012   LDP(A)                          InUse  Yes\n- '  (IPv4, vers:0, ''default'':4U, 37.0.0.0/24)'\n- 0     24013   LDP(A)                          InUse  Yes\n- '  (IPv4, vers:0, ''default'':4U, 27.0.0.0/24)'\n- 0     24014   LDP(A)                          InUse  Yes\n- '  (IPv4, vers:0, ''default'':4U, 47.0.0.0/24)'\n- 0     24015   LDP(A)                          InUse  Yes\n- '  (IPv4, vers:0, ''default'':4U, 34.0.0.0/24)'\n- 0     24016   LDP(A)                          InUse  Yes\n- '  (IPv4, vers:0, ''default'':4U, 78.0.0.0/24)'\n- 0     24017   LDP(A)                          InUse  Yes\n- '  (IPv4, vers:0, ''default'':4U, 48.0.0.0/24)'\n- 0     24018   LDP(A)                          InUse  Yes\n- '  (IPv4, vers:0, ''default'':4U, 45.0.0.0/24)'\n- 0     24020   ISIS(A):IGP                     InUse  Yes\n- '  (SR Adj Segment IPv4, vers:0, index=1, type=0, intf=Gi0/0/0/2, nh=12.0.0.2)'\n- 0     24021   ISIS(A):IGP                     InUse  Yes\n- '  (SR Adj Segment IPv4, vers:0, index=3, type=0, intf=Gi0/0/0/2, nh=12.0.0.2)'\n- 0     24022   LDP(A)                          InUse  Yes\n- '  (IPv4, vers:0, ''default'':4U, 8.8.8.8/32)'\nok: [PE1] =&gt; (item=show isis adjacency detail) =&gt; msg:\n- - - 'IS-IS IGP Level-2 adjacencies:'\n- System Id      Interface                SNPA           State Hold Changed  NSF IPv4 IPv6\n- '                                                                               BFD  BFD '\n- P2             Gi0/0/0/2                *PtoP*         Up    20   00:03:40 Yes None None\n- '  Area Address:           49'\n- '  Neighbor IPv4 Address:  12.0.0.2*'\n- '  Adjacency SID:          24020'\n- '  Non-FRR Adjacency SID:  24021'\n- '  Topology:               IPv4 Unicast'\n- '  BFD Status:             BFD Not Required, Neighbor Useable'\n- ''\n- 'Total adjacency count: 1'\nok: [PE1] =&gt; (item=show isis database verbose PE1) =&gt; msg:\n- - - IS-IS IGP (Level-2) Link State Database\n- LSPID                 LSP Seq Num  LSP Checksum  LSP Holdtime/Rcvd  ATT/P/OL\n- PE1.00-00           * 0x00000008   0x1448        1143 /*            0/0/0\n- '  Area Address:   49'\n- '  NLPID:          0xcc'\n- '  IP Address:     1.1.1.1'\n- '  Metric: 10         IP-Extended 12.0.0.0/24'\n- '    Prefix Attribute Flags: X:0 R:0 N:0 E:0 A:0'\n- '  Metric: 0          IP-Extended 1.1.1.1/32'\n- '    Prefix-SID Index: 1, Algorithm:0, R:0 N:1 P:0 E:0 V:0 L:0'\n- '    Prefix Attribute Flags: X:0 R:0 N:1 E:0 A:0'\n- '  Hostname:       PE1'\n- '  Router Cap:     1.1.1.1 D:0 S:0'\n- '    Segment Routing: I:1 V:0, SRGB Base: 16000 Range: 8000'\n- '    Node Maximum SID Depth: '\n- '      Label Imposition: 10'\n- '    SR Algorithm: '\n- '      Algorithm: 0'\n- '      Algorithm: 1'\n- '  Metric: 10         IS-Extended P2.00'\n- '    Local Interface ID: 9, Remote Interface ID: 9'\n- '    Interface IP Address: 12.0.0.1'\n- '    Neighbor IP Address: 12.0.0.2'\n- '    Physical BW: 1000000 kbits/sec'\n- '    ADJ-SID: F:0 B:0 V:1 L:1 S:0 P:0 weight:0 Adjacency-sid:24021'\n- ''\n- ' Total Level-2 LSP count: 1     Local Level-2 LSP count: 1'\nok: [PE1] =&gt; (item=show isis segment-routing label table) =&gt; msg:\n- - - IS-IS IGP IS Label Table\n- Label         Prefix                   Interface\n- '----------    ----------------         ---------'\n- 16001         1.1.1.1/32               Loopback0\n- '16002         2.2.2.2/32               '\n- '16003         3.3.3.3/32               '\n- '16006         6.6.6.6/32               '\n- 16007         7.7.7.7/32\nok: [PE1] =&gt; (item=show route 7.7.7.7/32 detail) =&gt; msg:\n- - - Routing entry for 7.7.7.7/32\n- '  Known via \"isis IGP\", distance 115, metric 20, labeled SR, type level-2'\n- '  Installed Mar  5 13:19:27.527 for 00:00:56'\n- '  Routing Descriptor Blocks'\n- '    12.0.0.2, from 7.7.7.7, via GigabitEthernet0/0/0/2'\n- '      Route metric is 20'\n- '      Label: 0x3e87 (16007)'\n- '      Tunnel ID: None'\n- '      Binding Label: None'\n- '      Extended communities count: 0'\n- \"      Path id:1\\t      Path ref count:0\"\n- '      NHID:0x2(Ref:20)'\n- '  Route version is 0xa (10)'\n- '  Local Label: 0x3e87 (16007)'\n- '  IP Precedence: Not Set'\n- '  QoS Group ID: Not Set'\n- '  Flow-tag: Not Set'\n- '  Fwd-class: Not Set'\n- '  Route Priority: RIB_PRIORITY_NON_RECURSIVE_MEDIUM (7) SVD Type RIB_SVD_TYPE_LOCAL'\n- '  Download Priority 1, Download Version 2317'\n- '  No advertising protos.'\nok: [PE1] =&gt; (item=show mpls forwarding) =&gt; msg:\n- - - 'Local  Outgoing    Prefix             Outgoing     Next Hop        Bytes       '\n- 'Label  Label       or ID              Interface                    Switched    '\n- '------ ----------- ------------------ ------------ --------------- ------------'\n- '16002  Pop         SR Pfx (idx 2)     Gi0/0/0/2    12.0.0.2        0           '\n- '16003  16003       SR Pfx (idx 3)     Gi0/0/0/2    12.0.0.2        0           '\n- '16006  16006       SR Pfx (idx 6)     Gi0/0/0/2    12.0.0.2        0           '\n- '16007  16007       SR Pfx (idx 7)     Gi0/0/0/2    12.0.0.2        0           '\n- '24000  Pop         2.2.2.2/32         Gi0/0/0/2    12.0.0.2        98          '\n- '24001  24001       3.3.3.3/32         Gi0/0/0/2    12.0.0.2        0           '\n- '24002  24002       6.6.6.6/32         Gi0/0/0/2    12.0.0.2        0           '\n- '24003  24003       7.7.7.7/32         Gi0/0/0/2    12.0.0.2        0           '\n- '24004  24004       4.4.4.4/32         Gi0/0/0/2    12.0.0.2        0           '\n- '24006  24006       5.5.5.5/32         Gi0/0/0/2    12.0.0.2        0           '\n- '24007  Pop         29.0.0.0/24        Gi0/0/0/2    12.0.0.2        0           '\n- '24008  24007       39.0.0.0/24        Gi0/0/0/2    12.0.0.2        0           '\n- '24009  Pop         23.0.0.0/24        Gi0/0/0/2    12.0.0.2        847         '\n- '24010  Pop         26.0.0.0/24        Gi0/0/0/2    12.0.0.2        0           '\n- '24011  24008       67.0.0.0/24        Gi0/0/0/2    12.0.0.2        0           '\n- '24012  24009       37.0.0.0/24        Gi0/0/0/2    12.0.0.2        0           '\n- '24013  Pop         27.0.0.0/24        Gi0/0/0/2    12.0.0.2        0           '\n- '24014  24010       47.0.0.0/24        Gi0/0/0/2    12.0.0.2        0           '\n- '24015  24011       34.0.0.0/24        Gi0/0/0/2    12.0.0.2        0           '\n- '24016  24012       78.0.0.0/24        Gi0/0/0/2    12.0.0.2        0           '\n- '24017  24013       48.0.0.0/24        Gi0/0/0/2    12.0.0.2        0           '\n- '24018  24014       45.0.0.0/24        Gi0/0/0/2    12.0.0.2        0           '\n- '24020  Pop         SR Adj (idx 1)     Gi0/0/0/2    12.0.0.2        0           '\n- '24021  Pop         SR Adj (idx 3)     Gi0/0/0/2    12.0.0.2        0           '\n- 24022  24030       8.8.8.8/32         Gi0/0/0/2    12.0.0.2        0\nok: [PE1] =&gt; (item=show cef 7.7.7.7/32) =&gt; msg:\n- - - 7.7.7.7/32, version 1544, labeled SR, internal 0x1000001 0x8130 (ptr 0xe832068) [1], 0x600 (0xe19f960), 0xa28 (0xebfe418)\n- ' Updated Mar  5 13:19:27.534 '\n- ' remote adjacency to GigabitEthernet0/0/0/2'\n- ' Prefix Len 32, traffic index 0, precedence n/a, priority 3'\n- ' Extensions: context-label:16007'\n- '  gateway array (0xe007750) reference count 9, flags 0x68, source lsd (5), 1 backups'\n- '                [4 type 5 flags 0x8401 (0xec414c8) ext 0x0 (0x0)]'\n- '  LW-LDI[type=5, refc=3, ptr=0xe19f960, sh-ldi=0xec414c8]'\n- '  gateway array update type-time 1 Mar  5 13:19:25.931'\n- ' LDI Update time Mar  5 13:19:25.931'\n- ' LW-LDI-TS Mar  5 13:19:27.534'\n- '   via 12.0.0.2/32, GigabitEthernet0/0/0/2, 14 dependencies, weight 0, class 0 [flags 0x0]'\n- '    path-idx 0 NHID 0x0 [0xf3a8790 0x0]'\n- '    next hop 12.0.0.2/32'\n- '    remote adjacency'\n- '     local label 24003      labels imposed {24003}'\n- ''\n- '    Load distribution: 0 (refcount 4)'\n- ''\n- '    Hash  OK  Interface                 Address'\n- '    0     Y   GigabitEthernet0/0/0/2    remote'\nok: [PE1] =&gt; (item=traceroute mpls ipv4 7.7.7.7/32) =&gt; msg:\n- - - Tracing MPLS Label Switched Path to 7.7.7.7/32, timeout is 2 seconds\n- ''\n- 'Codes: ''!'' - success, ''Q'' - request not sent, ''.'' - timeout,'\n- '  ''L'' - labeled output interface, ''B'' - unlabeled output interface, '\n- '  ''D'' - DS Map mismatch, ''F'' - no FEC mapping, ''f'' - FEC mismatch,'\n- '  ''M'' - malformed request, ''m'' - unsupported tlvs, ''N'' - no rx label, '\n- '  ''P'' - no rx intf label prot, ''p'' - premature termination of LSP, '\n- '  ''R'' - transit router, ''I'' - unknown upstream index,'\n- '  ''X'' - unknown return code, ''x'' - return code 0'\n- ''\n- Type escape sequence to abort.\n- ''\n- '  0 12.0.0.1 MRU 1500 [Labels: 24003 Exp: 0]'\n- 'L 1 12.0.0.2 MRU 1500 [Labels: implicit-null Exp: 0] 11 ms'\n- '! 2 27.0.0.7 10 ms'\nok: [PE1] =&gt; (item=traceroute sr-mpls 7.7.7.7/32) =&gt; msg:\n- - - Tracing MPLS Label Switched Path to 7.7.7.7/32, timeout is 2 seconds\n- ''\n- 'Codes: ''!'' - success, ''Q'' - request not sent, ''.'' - timeout,'\n- '  ''L'' - labeled output interface, ''B'' - unlabeled output interface, '\n- '  ''D'' - DS Map mismatch, ''F'' - no FEC mapping, ''f'' - FEC mismatch,'\n- '  ''M'' - malformed request, ''m'' - unsupported tlvs, ''N'' - no rx label, '\n- '  ''P'' - no rx intf label prot, ''p'' - premature termination of LSP, '\n- '  ''R'' - transit router, ''I'' - unknown upstream index,'\n- '  ''X'' - unknown return code, ''x'' - return code 0'\n- ''\n- Type escape sequence to abort.\n- ''\n- '  0 12.0.0.1 MRU 1500 [Labels: 16007 Exp: 0]'\n- 'L 1 12.0.0.2 MRU 1500 [Labels: implicit-null Exp: 0] 9 ms'\n- '! 2 27.0.0.7 7 ms'\nTASK [2.6 RENDER AND DISPLAY THE SR-PREFER CONFIGURATION] **********************\nok: [P2] =&gt; msg:\n- 'template: sr_prefer_template.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  segment-routing mpls sr-prefer'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P3] =&gt; msg:\n- 'template: sr_prefer_template.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  segment-routing mpls sr-prefer'\n- ' !'\n- '!'\n- ''\n- ''\nok: [PE1] =&gt; msg:\n- 'template: sr_prefer_template.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  segment-routing mpls sr-prefer'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P6] =&gt; msg:\n- 'template: sr_prefer_template.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  segment-routing mpls sr-prefer'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P7] =&gt; msg:\n- 'template: sr_prefer_template.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  segment-routing mpls sr-prefer'\n- ' !'\n- '!'\n- ''\n- ''\nTASK [2.7 RENDER AND SAVE THE SR-PREFER CONFIGURATION] *************************\nchanged: [P2]\nchanged: [P6]\nchanged: [P7]\nchanged: [PE1]\nchanged: [P3]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [PE1]\nTASK [2.8 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [PE1] =&gt; output.dest: xrcfg/PE1.srprefer.xrcfg\nok: [P3] =&gt; output.dest: xrcfg/P3.srprefer.xrcfg\nok: [P2] =&gt; output.dest: xrcfg/P2.srprefer.xrcfg\nok: [P6] =&gt; output.dest: xrcfg/P6.srprefer.xrcfg\nok: [P7] =&gt; output.dest: xrcfg/P7.srprefer.xrcfg\nTASK [2.9 RENDER AND APPLY THE SR-PREFER CONFIGURATION] ************************\nchanged: [P3]\nchanged: [PE1]\nchanged: [P2]\nchanged: [P6]\nchanged: [P7]\nPausing for 60 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 minutes PAUSE FOR CONVERGENCE] *****************************************\nok: [PE1]\nTASK [2.10 RUN COMMANDS TO VERIFY SR-PREFER STATE] *****************************\nok: [PE1] =&gt; (item=traceroute mpls ipv4 7.7.7.7/32)\nok: [PE1] =&gt; (item=traceroute mpls ipv4 5.5.5.5/32)\nTASK [2.11 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [PE1] =&gt; (item=traceroute mpls ipv4 7.7.7.7/32) =&gt; msg:\n- - - Tracing MPLS Label Switched Path to 7.7.7.7/32, timeout is 2 seconds\n- ''\n- 'Codes: ''!'' - success, ''Q'' - request not sent, ''.'' - timeout,'\n- '  ''L'' - labeled output interface, ''B'' - unlabeled output interface, '\n- '  ''D'' - DS Map mismatch, ''F'' - no FEC mapping, ''f'' - FEC mismatch,'\n- '  ''M'' - malformed request, ''m'' - unsupported tlvs, ''N'' - no rx label, '\n- '  ''P'' - no rx intf label prot, ''p'' - premature termination of LSP, '\n- '  ''R'' - transit router, ''I'' - unknown upstream index,'\n- '  ''X'' - unknown return code, ''x'' - return code 0'\n- ''\n- Type escape sequence to abort.\n- ''\n- '  0 12.0.0.1 MRU 1500 [Labels: 16007 Exp: 0]'\n- 'L 1 12.0.0.2 MRU 1500 [Labels: implicit-null Exp: 0] 14 ms'\n- '! 2 27.0.0.7 13 ms'\nok: [PE1] =&gt; (item=traceroute mpls ipv4 5.5.5.5/32) =&gt; msg:\n- - - Tracing MPLS Label Switched Path to 5.5.5.5/32, timeout is 2 seconds\n- ''\n- 'Codes: ''!'' - success, ''Q'' - request not sent, ''.'' - timeout,'\n- '  ''L'' - labeled output interface, ''B'' - unlabeled output interface, '\n- '  ''D'' - DS Map mismatch, ''F'' - no FEC mapping, ''f'' - FEC mismatch,'\n- '  ''M'' - malformed request, ''m'' - unsupported tlvs, ''N'' - no rx label, '\n- '  ''P'' - no rx intf label prot, ''p'' - premature termination of LSP, '\n- '  ''R'' - transit router, ''I'' - unknown upstream index,'\n- '  ''X'' - unknown return code, ''x'' - return code 0'\n- ''\n- Type escape sequence to abort.\n- ''\n- '  0 12.0.0.1 MRU 1500 [Labels: 24006 Exp: 0]'\n- 'L 1 12.0.0.2 MRU 1500 [Labels: 24009 Exp: 0] 6 ms'\n- 'L 2 27.0.0.7 MRU 1500 [Labels: 24001 Exp: 0] 8 ms'\n- 'L 3 47.0.0.4 MRU 1500 [Labels: implicit-null Exp: 0] 13 ms'\n- '! 4 45.0.0.5 16 ms'\n</code></pre>"},{"location":"all_inclusive_play/#sr-ldp-interworking","title":"SR - LDP Interworking","text":"SR - LDP Interworking <pre><code>PLAY [3. CISCO XRV9K SR WITH TI-LFA LAB PLAYBOOK - SR &lt;-&gt; LDP INTERWORKING] ****\nTASK [3.0 RENDER AND DISPLAY THE LDP REMOVAL CONFIGURATION] ********************\nok: [PE1] =&gt; msg:\n- 'template: sr_ldp_template.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  no mpls ldp auto-config '\n- ' !'\n- '!'\n- ''\n- ''\nok: [P2] =&gt; msg:\n- 'template: sr_ldp_template.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  no mpls ldp auto-config '\n- ' !'\n- '!'\n- ''\n- ''\nok: [P6] =&gt; msg:\n- 'template: sr_ldp_template.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  no mpls ldp auto-config '\n- ' !'\n- '!'\n- ''\n- ''\nTASK [3.1 RENDER AND SAVE THE LDP REMOVAL CONFIGURATION] ***********************\nchanged: [PE1]\nchanged: [P2]\nchanged: [P6]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [PE1]\nTASK [3.2 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [P2] =&gt; output.dest: xrcfg/P2.noldp.xrcfg\nok: [PE1] =&gt; output.dest: xrcfg/PE1.noldp.xrcfg\nok: [P6] =&gt; output.dest: xrcfg/P6.noldp.xrcfg\nTASK [3.3 RENDER AND APPLY THE LDP REMOVAL CONFIGURATION] **********************\nchanged: [P2]\nchanged: [PE1]\nchanged: [P6]\nPausing for 60 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 minutes PAUSE FOR CONVERGENCE] *****************************************\nok: [PE1]\nTASK [3.4 TRACEOUTE MPLS 5.5.5.5/32] *******************************************\nok: [PE1]\nTASK [3.5 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [PE1] =&gt; msg:\n- traceroute mpls ipv4 5.5.5.5/32\n- - Tracing MPLS Label Switched Path to 5.5.5.5/32, timeout is 2 seconds\n- ''\n- 'Codes: ''!'' - success, ''Q'' - request not sent, ''.'' - timeout,'\n- '  ''L'' - labeled output interface, ''B'' - unlabeled output interface, '\n- '  ''D'' - DS Map mismatch, ''F'' - no FEC mapping, ''f'' - FEC mismatch,'\n- '  ''M'' - malformed request, ''m'' - unsupported tlvs, ''N'' - no rx label, '\n- '  ''P'' - no rx intf label prot, ''p'' - premature termination of LSP, '\n- '  ''R'' - transit router, ''I'' - unknown upstream index,'\n- '  ''X'' - unknown return code, ''x'' - return code 0'\n- ''\n- Type escape sequence to abort.\n- ''\n- '  0 0.0.0.0 MRU 0 [No Label]'\n- Q 1 *\nTASK [3.6 STITCH LDP TO SR (works automatically) TRACEROUTE MPLS 1.1.1.1/32] ***\nok: [PE5] =&gt; (item=traceroute mpls ipv4 1.1.1.1/32)\nok: [PE5] =&gt; (item=traceroute mpls multipath ipv4 1.1.1.1/32 verbose)\nTASK [3.7 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [PE5] =&gt; (item=traceroute mpls ipv4 1.1.1.1/32) =&gt; msg:\n- - - Tracing MPLS Label Switched Path to 1.1.1.1/32, timeout is 2 seconds\n- ''\n- 'Codes: ''!'' - success, ''Q'' - request not sent, ''.'' - timeout,'\n- '  ''L'' - labeled output interface, ''B'' - unlabeled output interface, '\n- '  ''D'' - DS Map mismatch, ''F'' - no FEC mapping, ''f'' - FEC mismatch,'\n- '  ''M'' - malformed request, ''m'' - unsupported tlvs, ''N'' - no rx label, '\n- '  ''P'' - no rx intf label prot, ''p'' - premature termination of LSP, '\n- '  ''R'' - transit router, ''I'' - unknown upstream index,'\n- '  ''X'' - unknown return code, ''x'' - return code 0'\n- ''\n- Type escape sequence to abort.\n- ''\n- '  0 45.0.0.5 MRU 1500 [Labels: 24013 Exp: 0]'\n- 'L 1 45.0.0.4 MRU 1500 [Labels: 24013 Exp: 0] 21 ms'\n- 'L 2 34.0.0.3 MRU 1500 [Labels: 16001 Exp: 0] 15 ms'\n- 'L 3 23.0.0.2 MRU 1500 [Labels: implicit-null Exp: 0] 13 ms'\n- '! 4 12.0.0.1 16 ms'\nok: [PE5] =&gt; (item=traceroute mpls multipath ipv4 1.1.1.1/32 verbose) =&gt; msg:\n- - - Starting LSP Path Discovery for 1.1.1.1/32\n- ''\n- 'Codes: ''!'' - success, ''Q'' - request not sent, ''.'' - timeout,'\n- '  ''L'' - labeled output interface, ''B'' - unlabeled output interface, '\n- '  ''D'' - DS Map mismatch, ''F'' - no FEC mapping, ''f'' - FEC mismatch,'\n- '  ''M'' - malformed request, ''m'' - unsupported tlvs, ''N'' - no rx label, '\n- '  ''P'' - no rx intf label prot, ''p'' - premature termination of LSP, '\n- '  ''R'' - transit router, ''I'' - unknown upstream index,'\n- '  ''X'' - unknown return code, ''x'' - return code 0'\n- ''\n- Type escape sequence to abort.\n- ''\n- LLL!\n- 'Path 0 found, '\n- ' output interface GigabitEthernet0/0/0/0 nexthop 45.0.0.4'\n- ' source 45.0.0.5 destination 127.0.0.0'\n- '  0 45.0.0.5 45.0.0.4 MRU 1500 [Labels: 24013 Exp: 0] multipaths 0'\n- 'L 1 45.0.0.4 47.0.0.7 MRU 1500 [Labels: 24012 Exp: 0] ret code 8 multipaths 2'\n- 'L 2 47.0.0.7 27.0.0.2 MRU 1500 [Labels: 16001 Exp: 0] ret code 8 multipaths 1'\n- 'L 3 27.0.0.2 12.0.0.1 MRU 1500 [Labels: implicit-null Exp: 0] ret code 8 multipaths 1'\n- '! 4 12.0.0.1, ret code 3 multipaths 0'\n- LL!\n- 'Path 1 found, '\n- ' output interface GigabitEthernet0/0/0/0 nexthop 45.0.0.4'\n- ' source 45.0.0.5 destination 127.0.0.1'\n- '  0 45.0.0.5 45.0.0.4 MRU 1500 [Labels: 24013 Exp: 0] multipaths 0'\n- 'L 1 45.0.0.4 34.0.0.3 MRU 1500 [Labels: 24013 Exp: 0] ret code 8 multipaths 2'\n- 'L 2 34.0.0.3 23.0.0.2 MRU 1500 [Labels: 16001 Exp: 0] ret code 8 multipaths 1'\n- 'L 3 23.0.0.2 12.0.0.1 MRU 1500 [Labels: implicit-null Exp: 0] ret code 8 multipaths 1'\n- '! 4 12.0.0.1, ret code 3 multipaths 0'\n- ''\n- Paths (found/broken/unexplored) (2/0/0)\n- ' Echo Request (sent/fail) (7/0)'\n- ' Echo Reply (received/timeout) (7/0)'\n- ' Total Time Elapsed 84 ms'\nTASK [3.8 RUN COMMANDS TO VERIFY LDP TO SR LABEL STITCHING] ********************\nok: [P3] =&gt; (item=show cef 1.1.1.1/32)\nok: [P3] =&gt; (item=show mpls forwarding prefix 1.1.1.1/32)\nok: [P3] =&gt; (item=show mpls ldp forwarding 1.1.1.1/32)\nTASK [3.9 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [P3] =&gt; (item=show cef 1.1.1.1/32) =&gt; msg:\n- - - 1.1.1.1/32, version 3303, labeled SR, internal 0x1000001 0x8310 (ptr 0xe82ef98) [1], 0x600 (0xe19fa38), 0xa28 (0xebfebe8)\n- ' Updated Mar  5 13:20:40.204 '\n- ' remote adjacency to GigabitEthernet0/0/0/0'\n- ' Prefix Len 32, traffic index 0, precedence n/a, priority 1'\n- '  gateway array (0xe009e48) reference count 3, flags 0x68, source rib (7), 1 backups'\n- '                [2 type 5 flags 0x8401 (0xec42c08) ext 0x0 (0x0)]'\n- '  LW-LDI[type=5, refc=3, ptr=0xe19fa38, sh-ldi=0xec42c08]'\n- '  gateway array update type-time 1 Mar  5 13:20:40.204'\n- ' LDI Update time Mar  5 13:20:40.204'\n- ' LW-LDI-TS Mar  5 13:20:40.204'\n- '   via 23.0.0.2/32, GigabitEthernet0/0/0/0, 12 dependencies, weight 0, class 0 [flags 0x0]'\n- '    path-idx 0 NHID 0x0 [0xf399c90 0x0]'\n- '    next hop 23.0.0.2/32'\n- '    remote adjacency'\n- '     local label 16001      labels imposed {16001}'\n- ''\n- '    Load distribution: 0 (refcount 2)'\n- ''\n- '    Hash  OK  Interface                 Address'\n- '    0     Y   GigabitEthernet0/0/0/0    remote'\nok: [P3] =&gt; (item=show mpls forwarding prefix 1.1.1.1/32) =&gt; msg:\n- - - 'Local  Outgoing    Prefix             Outgoing     Next Hop        Bytes       '\n- 'Label  Label       or ID              Interface                    Switched    '\n- '------ ----------- ------------------ ------------ --------------- ------------'\n- 16001  16001       SR Pfx (idx 1)     Gi0/0/0/0    23.0.0.2        0\nok: [P3] =&gt; (item=show mpls ldp forwarding 1.1.1.1/32) =&gt; msg:\n- - - 'Codes: '\n- '  - = GR label recovering, (!) = LFA FRR pure backup path '\n- '  {} = Label stack with multi-line output for a routing path'\n- '  G = GR, S = Stale, R = Remote LFA FRR backup'\n- '  E = Entropy label capability'\n- ''\n- 'Prefix          Label   Label(s)       Outgoing     Next Hop            Flags  '\n- '                In      Out            Interface                        G S R E'\n- '--------------- ------- -------------- ------------ ------------------- -------'\n- 1.1.1.1/32      24013   Unlabelled     Gi0/0/0/0    23.0.0.2\nTASK [3.10 RUN AND PARSE WITH TTP(TEMPLATE TEXT PARSER) TO CAPTURE LOCAL LDP LABEL] ***\nok: [P3]\nTASK [3.11 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [P3] =&gt; msg:\n- show mpls ldp forwarding 1.1.1.1/32\n- - - in_label: '24013'\nout_label: Unlabelled\nTASK [3.12 USE THE CAPTURED LOCAL/IN LABEL TO VERIFY STITCHED SR LABEL] ********\nok: [P3] =&gt; (item=show mpls forwarding labels 24013)\nok: [P3] =&gt; (item=show cef mpls local-label 24013 eOS detail)\nTASK [3.13 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [P3] =&gt; (item=show mpls forwarding labels 24013) =&gt; msg:\n- - - 'Local  Outgoing    Prefix             Outgoing     Next Hop        Bytes       '\n- 'Label  Label       or ID              Interface                    Switched    '\n- '------ ----------- ------------------ ------------ --------------- ------------'\n- 24013  16001       1.1.1.1/32         Gi0/0/0/0    23.0.0.2        496\nok: [P3] =&gt; (item=show cef mpls local-label 24013 eOS detail) =&gt; msg:\n- - - Label/EOS 24013/1, Label-type Unknown, version 2241, labeled SR, internal 0x1000001 0x87f0 (ptr 0xe37b860) [1], 0x600 (0xe19fe70), 0xa28 (0xebfe4b8)\n- ' Updated Mar  5 13:21:54.559 '\n- ' remote adjacency to GigabitEthernet0/0/0/0'\n- ' Prefix Len 21, traffic index 0, precedence n/a, priority 15'\n- ' Extensions: context-label:16001'\n- '  gateway array (0xe00abe0) reference count 2, flags 0x48, source lsd (5), 0 backups'\n- '                [2 type 6 flags 0x8401 (0xec42188) ext 0x0 (0x0)]'\n- '  LW-LDI[type=6, refc=2, ptr=0xe19fe70, sh-ldi=0xec42188]'\n- '  gateway array update type-time 1 Mar  5 13:19:26.967'\n- ' LDI Update time Mar  5 13:20:40.205'\n- ' LW-LDI-TS Mar  5 13:21:54.560'\n- '   via 23.0.0.2/32, GigabitEthernet0/0/0/0, 12 dependencies, weight 0, class 0 [flags 0x0]'\n- '    path-idx 0 NHID 0x0 [0xf399c90 0x0]'\n- '    next hop 23.0.0.2/32'\n- '    remote adjacency'\n- '     local label 24013      labels imposed {16001}'\n- ''\n- '    Load distribution: 0 (refcount 2)'\n- ''\n- '    Hash  OK  Interface                 Address'\n- '    0     Y   GigabitEthernet0/0/0/0    remote'\nTASK [3.14 RENDER AND DISPLAY SRMS [SEGMENT ROUTING MAPPING SERVER] CONFIGURATION] ***\nok: [P6] =&gt; msg:\n- 'template: srms_template.j2'\n- - segment-routing\n- ' mapping-server'\n- '  prefix-sid-map'\n- '   address-family ipv4'\n- '    4.4.4.4/32 4'\n- '    5.5.5.5/32 5'\n- '    8.8.8.8/32 8'\n- '   !'\n- '  !'\n- ' !'\n- '!'\n- root\n- ''\n- router isis IGP\n- ' address-family ipv4 unicast'\n- '  segment-routing prefix-sid-map advertise-local'\n- ' !'\n- '!'\n- root\n- '!'\n- ''\n- ''\nTASK [3.15 RENDER AND SAVE SRMS [SEGMENT ROUTING MAPPING SERVER] CONFIGURATION] ***\nchanged: [P6]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [PE1]\nTASK [3.16 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [P6] =&gt; output.dest: xrcfg/P6.srms.xrcfg\nTASK [3.17 STITCH SR TO LDP (RENDER AND CONFIGURE SRMS [SEGMENT ROUTING MAPPING SERVER])] ***\nchanged: [P6]\nPausing for 60 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 minutes PAUSE FOR CONVERGENCE] *****************************************\nok: [PE1]\nTASK [3.18 RUN COMMANDS TO VERIFY SR TO LDP LABEL STITCHING] *******************\nok: [P3]\nTASK [3.19 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [P3] =&gt; msg:\n- show cef 5.5.5.5/32\n- - - 5.5.5.5/32, version 3328, labeled SR, internal 0x1000001 0x87f0 (ptr 0xe82f258) [1], 0x600 (0xe19fd98), 0xa28 (0xebfe3c8)\n- ' Updated Mar  5 13:23:28.487 '\n- ' remote adjacency to GigabitEthernet0/0/0/2'\n- ' Prefix Len 32, traffic index 0, precedence n/a, priority 15'\n- '  gateway array (0xe00aa10) reference count 3, flags 0x68, source rib (7), 2 backups'\n- '                [2 type 5 flags 0x8401 (0xec42248) ext 0x0 (0x0)]'\n- '  LW-LDI[type=5, refc=3, ptr=0xe19fd98, sh-ldi=0xec42248]'\n- '  gateway array update type-time 1 Mar  5 13:23:28.486'\n- ' LDI Update time Mar  5 13:23:28.493'\n- ' LW-LDI-TS Mar  5 13:23:28.493'\n- '   via 34.0.0.4/32, GigabitEthernet0/0/0/2, 16 dependencies, weight 0, class 0 [flags 0x0]'\n- '    path-idx 0 NHID 0x0 [0xf399d30 0x0]'\n- '    next hop 34.0.0.4/32'\n- '    remote adjacency'\n- '     local label 16005      labels imposed {24001}'\n- ''\n- '    Load distribution: 0 (refcount 2)'\n- ''\n- '    Hash  OK  Interface                 Address'\n- '    0     Y   GigabitEthernet0/0/0/2    remote'\nTASK [3.20 TRACEOUTE MPLS 5.5.5.5/32] ******************************************\nok: [PE1]\nTASK [3.21 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [PE1] =&gt; msg:\n- traceroute sr-mpls 5.5.5.5/32\n- - - Tracing MPLS Label Switched Path to 5.5.5.5/32, timeout is 2 seconds\n- ''\n- 'Codes: ''!'' - success, ''Q'' - request not sent, ''.'' - timeout,'\n- '  ''L'' - labeled output interface, ''B'' - unlabeled output interface, '\n- '  ''D'' - DS Map mismatch, ''F'' - no FEC mapping, ''f'' - FEC mismatch,'\n- '  ''M'' - malformed request, ''m'' - unsupported tlvs, ''N'' - no rx label, '\n- '  ''P'' - no rx intf label prot, ''p'' - premature termination of LSP, '\n- '  ''R'' - transit router, ''I'' - unknown upstream index,'\n- '  ''X'' - unknown return code, ''x'' - return code 0'\n- ''\n- Type escape sequence to abort.\n- ''\n- '  0 12.0.0.1 MRU 1500 [Labels: 16005 Exp: 0]'\n- 'L 1 12.0.0.2 MRU 1500 [Labels: 16005 Exp: 0] 26 ms'\n- 'L 2 27.0.0.7 MRU 1500 [Labels: 24001 Exp: 0] 19 ms'\n- 'L 3 47.0.0.4 MRU 1500 [Labels: implicit-null Exp: 0] 15 ms'\n- '! 4 45.0.0.5 12 ms'\nTASK [3.22 RENDER AND DISPLAY SR-PREFER CONFIGURATION] *************************\nok: [PE5] =&gt; msg:\n- 'template: sr_only_part1.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  segment-routing mpls sr-prefer'\n- ' !'\n- ' interface Loopback0'\n- '  address-family ipv4 unicast'\n- '   prefix-sid index 5'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P4] =&gt; msg:\n- 'template: sr_only_part1.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  segment-routing mpls sr-prefer'\n- ' !'\n- ' interface Loopback0'\n- '  address-family ipv4 unicast'\n- '   prefix-sid index 4'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P8] =&gt; msg:\n- 'template: sr_only_part1.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  segment-routing mpls sr-prefer'\n- ' !'\n- ' interface Loopback0'\n- '  address-family ipv4 unicast'\n- '   prefix-sid index 8'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nTASK [3.23 RENDER AND SAVE THE SR-PREFER CONFIGURATION] ************************\nchanged: [PE5]\nchanged: [P8]\nchanged: [P4]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [PE1]\nTASK [3.24 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [PE5] =&gt; output.dest: xrcfg/PE5.sronly_p1.xrcfg\nok: [P4] =&gt; output.dest: xrcfg/P4.sronly_p1.xrcfg\nok: [P8] =&gt; output.dest: xrcfg/P8.sronly_p1.xrcfg\nTASK [3.25 CONFIGURE SR WITH SR-PREFER ON REMAINING ROUTERS] *******************\nchanged: [PE5]\nchanged: [P8]\nchanged: [P4]\nTASK [3.26 RENDER AND DISPLAY REMOVE LDP CONFIGURATION] ************************\nok: [P3] =&gt; msg:\n- 'template: sr_only_remove_ldp.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  no mpls ldp auto-config'\n- ' !'\n- '!'\n- ''\n- ''\nok: [PE1] =&gt; msg:\n- 'template: sr_only_remove_ldp.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  no mpls ldp auto-config'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P6] =&gt; msg:\n- 'template: sr_only_remove_ldp.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  no mpls ldp auto-config'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P4] =&gt; msg:\n- 'template: sr_only_remove_ldp.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  no mpls ldp auto-config'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P8] =&gt; msg:\n- 'template: sr_only_remove_ldp.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  no mpls ldp auto-config'\n- ' !'\n- '!'\n- ''\n- ''\nok: [PE5] =&gt; msg:\n- 'template: sr_only_remove_ldp.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  no mpls ldp auto-config'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P2] =&gt; msg:\n- 'template: sr_only_remove_ldp.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  no mpls ldp auto-config'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P7] =&gt; msg:\n- 'template: sr_only_remove_ldp.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  no mpls ldp auto-config'\n- ' !'\n- '!'\n- ''\n- ''\nTASK [3.27 RENDER AND SAVE REMOVE LDP CONFIGURATION] ***************************\nchanged: [PE1]\nchanged: [P2]\nchanged: [P6]\nchanged: [P4]\nchanged: [P7]\nchanged: [P8]\nchanged: [P3]\nchanged: [PE5]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [PE1]\nTASK [3.28 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [PE1] =&gt; output.dest: xrcfg/PE1.noldp.xrcfg\nok: [P2] =&gt; output.dest: xrcfg/P2.noldp.xrcfg\nok: [P3] =&gt; output.dest: xrcfg/P3.noldp.xrcfg\nok: [PE5] =&gt; output.dest: xrcfg/PE5.noldp.xrcfg\nok: [P8] =&gt; output.dest: xrcfg/P8.noldp.xrcfg\nok: [P6] =&gt; output.dest: xrcfg/P6.noldp.xrcfg\nok: [P4] =&gt; output.dest: xrcfg/P4.noldp.xrcfg\nok: [P7] =&gt; output.dest: xrcfg/P7.noldp.xrcfg\nTASK [3.29 REMOVE LDP FROM ALL ROUTERS] ****************************************\nchanged: [P4]\nchanged: [P3]\nchanged: [PE1]\nchanged: [P6]\nchanged: [P8]\nchanged: [PE5]\nchanged: [P2]\nchanged: [P7]\nTASK [3.30 RENDER AND DISPLAY SRMS REMOVAL CONFIGURATION] **********************\nok: [P6] =&gt; msg:\n- 'template: sr_only_remove_srms.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  no segment-routing prefix-sid-map advertise-local'\n- ' !'\n- '!'\n- root\n- ''\n- no segment-routing\n- '!'\n- ''\n- ''\nTASK [3.31 RENDER AND SAVE SRMS REMOVAL CONFIGURATION] *************************\nchanged: [P6]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [PE1]\nTASK [3.32 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [P6] =&gt; output.dest: xrcfg/P6.nosrms.xrcfg\nTASK [3.33 RENDER AND REMOVE SRMS CONFIGURATION FROM P6] ***********************\nchanged: [P6]\n</code></pre>"},{"location":"all_inclusive_play/#ti-lfa-topology-independent-loopfree-alternate","title":"TI-LFA (Topology Independent - LoopFree Alternate)","text":"SR Only <pre><code>PLAY [4. CISCO XRV9K SR WITH TI-LFA LAB PLAYBOOK - TOPOLOGY INDEPENDENT LOOPFREE ALTERNATE] ***\nTASK [4.0 RENDER AND DISPLAY THE TI-LFA CONFIGURATION] *************************\nok: [PE1] =&gt; msg:\n- 'template: tilfa.j2'\n- - router isis IGP interface GigabitEthernet0/0/0/2 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/2 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- '!'\n- ''\n- ''\nok: [P2] =&gt; msg:\n- 'template: tilfa.j2'\n- - router isis IGP interface GigabitEthernet0/0/0/0 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/0 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- router isis IGP interface GigabitEthernet0/0/0/1 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/1 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- router isis IGP interface GigabitEthernet0/0/0/2 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/2 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- router isis IGP interface GigabitEthernet0/0/0/3 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/3 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- router isis IGP interface GigabitEthernet0/0/0/5 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/5 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- '!'\n- ''\n- ''\nok: [P4] =&gt; msg:\n- 'template: tilfa.j2'\n- - router isis IGP interface GigabitEthernet0/0/0/0 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/0 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- router isis IGP interface GigabitEthernet0/0/0/1 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/1 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- router isis IGP interface GigabitEthernet0/0/0/2 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/2 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- router isis IGP interface GigabitEthernet0/0/0/4 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/4 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- '!'\n- ''\n- ''\nok: [P6] =&gt; msg:\n- 'template: tilfa.j2'\n- - router isis IGP interface GigabitEthernet0/0/0/0 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/0 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- router isis IGP interface GigabitEthernet0/0/0/1 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/1 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- '!'\n- ''\n- ''\nok: [P3] =&gt; msg:\n- 'template: tilfa.j2'\n- - router isis IGP interface GigabitEthernet0/0/0/0 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/0 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- router isis IGP interface GigabitEthernet0/0/0/1 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/1 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- router isis IGP interface GigabitEthernet0/0/0/2 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/2 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- router isis IGP interface GigabitEthernet0/0/0/3 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/3 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- '!'\n- ''\n- ''\nok: [PE5] =&gt; msg:\n- 'template: tilfa.j2'\n- - router isis IGP interface GigabitEthernet0/0/0/0 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/0 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- '!'\n- ''\n- ''\nok: [P7] =&gt; msg:\n- 'template: tilfa.j2'\n- - router isis IGP interface GigabitEthernet0/0/0/0 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/0 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- router isis IGP interface GigabitEthernet0/0/0/1 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/1 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- router isis IGP interface GigabitEthernet0/0/0/2 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/2 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- router isis IGP interface GigabitEthernet0/0/0/3 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/3 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- router isis IGP interface GigabitEthernet0/0/0/4 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/4 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- '!'\n- ''\n- ''\nok: [P8] =&gt; msg:\n- 'template: tilfa.j2'\n- - router isis IGP interface GigabitEthernet0/0/0/0 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/0 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- router isis IGP interface GigabitEthernet0/0/0/1 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/1 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- router isis IGP interface GigabitEthernet0/0/0/2 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/2 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- '!'\n- ''\n- ''\nTASK [4.1 RENDER AND SAVE THE TI-LFA CONFIGURATION] ****************************\nchanged: [P3]\nchanged: [PE1]\nchanged: [P7]\nchanged: [PE5]\nchanged: [P4]\nchanged: [P8]\nchanged: [P2]\nchanged: [P6]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [PE1]\nTASK [4.2 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [PE1] =&gt; output.dest: xrcfg/PE1.tilfa.xrcfg\nok: [P2] =&gt; output.dest: xrcfg/P2.tilfa.xrcfg\nok: [P6] =&gt; output.dest: xrcfg/P6.tilfa.xrcfg\nok: [P7] =&gt; output.dest: xrcfg/P7.tilfa.xrcfg\nok: [P8] =&gt; output.dest: xrcfg/P8.tilfa.xrcfg\nok: [P4] =&gt; output.dest: xrcfg/P4.tilfa.xrcfg\nok: [PE5] =&gt; output.dest: xrcfg/PE5.tilfa.xrcfg\nok: [P3] =&gt; output.dest: xrcfg/P3.tilfa.xrcfg\nTASK [4.3 RENDER AND APPLY THE TI-LFA CONFIGURATION] ***************************\nchanged: [PE5]\nchanged: [PE1]\nchanged: [P6]\nchanged: [P3]\nchanged: [P4]\nchanged: [P2]\nchanged: [P7]\nchanged: [P8]\nPausing for 60 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 minutes PAUSE FOR CONVERGENCE] *****************************************\nok: [PE1]\nTASK [4.4 RUN COMMANDS TO VERIFY TI-LFA IS ENABLED] ****************************\nok: [P2] =&gt; (item=show isis interface GigabitEthernet 0/0/0/0)\nok: [P2] =&gt; (item=show isis fast-reroute 5.5.5.5/32 detail)\nok: [P2] =&gt; (item=show route 5.5.5.5/32)\nok: [P2] =&gt; (item=show cef 5.5.5.5/32)\nTASK [4.5 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [P2] =&gt; (item=show isis interface GigabitEthernet 0/0/0/0) =&gt; msg:\n- - - GigabitEthernet0/0/0/0      Enabled\n- '  Adjacency Formation:      Enabled'\n- '  Prefix Advertisement:     Enabled'\n- '  IPv4 BFD:                 Disabled'\n- '  IPv6 BFD:                 Disabled'\n- '  BFD Min Interval:         150'\n- '  BFD Multiplier:           3'\n- '  RSI SRLG:                 Registered'\n- '  Bandwidth:                1000000'\n- '  '\n- '  Circuit Type:             level-2-only'\n- '  Media Type:               P2P'\n- '  Circuit Number:           0'\n- '  Measured Delay:           Min:- Avg:- Max:- usec'\n- '  Delay Normalization:      Interval:0 Offset:0'\n- '  Normalized Delay:         Min:- Avg:- Max:- usec'\n- '  Link Loss:                -'\n- '  Extended Circuit Number:  7'\n- '  Next P2P IIH in:          1 s'\n- '  LSP Rexmit Queue Size:    0'\n- '  '\n- '  Level-2                   '\n- '    Adjacency Count:        1'\n- '    LSP Pacing Interval:    33 ms'\n- '    PSNP Entry Queue Size:  0'\n- '    Hello Interval:         10 s'\n- '    Hello Multiplier:       3'\n- '  '\n- '  CLNS I/O'\n- '    Protocol State:         Up'\n- '    MTU:                    1497'\n- '    SNPA:                   5005.0004.0003'\n- '    Layer-2 MCast Groups Membership:'\n- '      All ISs:              Yes'\n- '  '\n- '  IPv4 Unicast Topology:    Enabled'\n- '    Adjacency Formation:    Running'\n- '    Prefix Advertisement:   Running'\n- '          Policy (L1/L2):   -/-'\n- '    Metric (L1/L2):         0/10'\n- '    Metric fallback:'\n- '      Bandwidth (L1/L2):    Inactive/Inactive'\n- '      Anomaly (L1/L2):      Inactive/Inactive'\n- '    Weight (L1/L2):         0/0'\n- '    MPLS Max Label Stack:   3/3/10/10 (PRI/BKP/SRTE/SRAT)'\n- '    MPLS LDP Sync (L1/L2):  Disabled/Disabled'\n- '    FRR (L1/L2):            L1 Enabled         L2 Enabled     '\n- '      FRR Type:             per-prefix         per-prefix     '\n- '      Direct LFA:           Enabled            Enabled        '\n- '      Remote LFA:           Not Enabled        Not Enabled    '\n- '       Tie Breaker          Default            Default        '\n- '       Line-card disjoint   30                 30             '\n- '       Lowest backup metric 20                 20             '\n- '       Node protecting      40                 40             '\n- '       Primary path         10                 10             '\n- '      TI LFA:               Enabled            Enabled        '\n- '       Tie Breaker          Default            Default        '\n- '       Link Protecting      Enabled            Enabled        '\n- '       Line-card disjoint   0                  0              '\n- '       Node protecting      0                  0              '\n- '       SRLG disjoint        0                  0              '\n- '  '\n- '  IPv4 Address Family:      Enabled'\n- '    Protocol State:         Up'\n- '    Forwarding Address(es): 23.0.0.2'\n- '    Global Prefix(es):      23.0.0.0/24'\n- '  '\n- '  LSP transmit timer expires in 0 ms'\n- '  LSP transmission is idle'\n- '  Can send up to 8 back-to-back LSPs in the next 0 ms'\nok: [P2] =&gt; (item=show isis fast-reroute 5.5.5.5/32 detail) =&gt; msg:\n- - - 'L2 5.5.5.5/32 [30/115] Label: 16005, medium priority'\n- '   Installed Mar 05 13:25:10.107 for 00:01:02'\n- '     via 23.0.0.3, GigabitEthernet0/0/0/0, Label: 16005, P3, SRGB Base: 16000, Weight: 0'\n- '       Backup path: LFA, via 27.0.0.7, GigabitEthernet0/0/0/3, Label: 16005, P7, SRGB Base: 16000, Weight: 0, Metric: 30'\n- '       P: Yes, TM: 30, LC: No, NP: Yes, D: Yes, SRLG: Yes'\n- '     via 27.0.0.7, GigabitEthernet0/0/0/3, Label: 16005, P7, SRGB Base: 16000, Weight: 0'\n- '       Backup path: LFA, via 23.0.0.3, GigabitEthernet0/0/0/0, Label: 16005, P3, SRGB Base: 16000, Weight: 0, Metric: 30'\n- '       P: Yes, TM: 30, LC: No, NP: Yes, D: Yes, SRLG: Yes'\n- '     src PE5.00-00, 5.5.5.5, prefix-SID index 5, R:0 N:1 P:0 E:0 V:0 L:0, Alg:0'\nok: [P2] =&gt; (item=show route 5.5.5.5/32) =&gt; msg:\n- - - Routing entry for 5.5.5.5/32\n- '  Known via \"isis IGP\", distance 115, metric 30, labeled SR, type level-2'\n- '  Installed Mar  5 13:25:10.107 for 00:01:03'\n- '  Routing Descriptor Blocks'\n- '    23.0.0.3, from 5.5.5.5, via GigabitEthernet0/0/0/0, Protected, ECMP-Backup (Local-LFA)'\n- '      Route metric is 30'\n- '    27.0.0.7, from 5.5.5.5, via GigabitEthernet0/0/0/3, Protected, ECMP-Backup (Local-LFA)'\n- '      Route metric is 30'\n- '  No advertising protos.'\nok: [P2] =&gt; (item=show cef 5.5.5.5/32) =&gt; msg:\n- - - 5.5.5.5/32, version 4150, labeled SR, internal 0x1000001 0x8310 (ptr 0xe831808) [1], 0x600 (0xe1a0c80), 0xa28 (0xf6564c8)\n- ' Updated Mar  5 13:25:10.137 '\n- ' remote adjacency to GigabitEthernet0/0/0/0'\n- ' Prefix Len 32, traffic index 0, precedence n/a, priority 1'\n- '  gateway array (0xe00b238) reference count 6, flags 0x400068, source rib (7), 1 backups'\n- '                [3 type 5 flags 0x8401 (0xec245a8) ext 0x0 (0x0)]'\n- '  LW-LDI[type=5, refc=3, ptr=0xe1a0c80, sh-ldi=0xec245a8]'\n- '  gateway array update type-time 1 Mar  5 13:25:10.137'\n- ' LDI Update time Mar  5 13:25:10.137'\n- ' LW-LDI-TS Mar  5 13:25:10.137'\n- '   via 23.0.0.3/32, GigabitEthernet0/0/0/0, 10 dependencies, weight 0, class 0, protected, ECMP-backup (Local-LFA) [flags 0x600]'\n- '    path-idx 0 bkup-idx 1 NHID 0x0 [0xddb6810 0x0]'\n- '    next hop 23.0.0.3/32'\n- '     local label 16005      labels imposed {16005}'\n- '   via 27.0.0.7/32, GigabitEthernet0/0/0/3, 8 dependencies, weight 0, class 0, protected, ECMP-backup (Local-LFA) [flags 0x600]'\n- '    path-idx 1 bkup-idx 0 NHID 0x0 [0xddb5280 0x0]'\n- '    next hop 27.0.0.7/32'\n- '     local label 16005      labels imposed {16005}'\n- ''\n- '    Load distribution: 0 1 (refcount 3)'\n- ''\n- '    Hash  OK  Interface                 Address'\n- '    0     Y   GigabitEthernet0/0/0/0    remote         '\n- '    1     Y   GigabitEthernet0/0/0/3    remote'\n</code></pre>"},{"location":"all_inclusive_play/#zero-segment-ti-lfa","title":"Zero Segment TI-LFA","text":"Zero Segment TI-LFA <pre><code>PLAY [5. CISCO XRV9K SR WITH TI-LFA LAB PLAYBOOK - ZERO SEGMENT TI-LFA] ********\nTASK [5.0 RENDER AND DISPLAY THE ZERO SEGMENT TI-LFA CONFIGURATION] ************\nok: [P2] =&gt; msg:\n- 'template: zs_tilfa_p2.j2'\n- - router isis IGP\n- ' interface GigabitEthernet0/0/0/1'\n- '  address-family ipv4 unicast'\n- '   metric 100'\n- '  !'\n- ' !'\n- ' interface GigabitEthernet0/0/0/3'\n- '  address-family ipv4 unicast'\n- '   metric 100'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P6] =&gt; msg:\n- 'template: zs_tilfa_p6.j2'\n- - router isis IGP\n- ' interface GigabitEthernet0/0/0/1'\n- '  address-family ipv4 unicast'\n- '   metric 100'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P7] =&gt; msg:\n- 'template: zs_tilfa_p7.j2'\n- - router isis IGP\n- ' interface GigabitEthernet0/0/0/3'\n- '  address-family ipv4 unicast'\n- '   metric 100'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nTASK [5.1 RENDER AND SAVE THE ZERO SEGMENT TI-LFA CONFIGURATION] ***************\nchanged: [P7]\nchanged: [P2]\nchanged: [P6]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [P2]\nTASK [5.2 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [P2] =&gt; output.dest: xrcfg/P2.zs_tilfa.xrcfg\nok: [P6] =&gt; output.dest: xrcfg/P6.zs_tilfa.xrcfg\nok: [P7] =&gt; output.dest: xrcfg/P7.zs_tilfa.xrcfg\nTASK [5.3 RENDER AND APPLY THE ZERO SEGMENT TI-LFA CONFIGURATION] **************\nchanged: [P6]\nchanged: [P7]\nchanged: [P2]\nPausing for 60 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 minutes PAUSE FOR CONVERGENCE] *****************************************\nok: [P2]\nTASK [5.4 RUN COMMANDS TO VERIFY ZERO SEGMENT TI-LFA SCENARIO] *****************\nok: [P2] =&gt; (item=show isis route 5.5.5.5/32 detail)\nok: [P2] =&gt; (item=show isis fast-reroute 5.5.5.5/32 detail)\nok: [P2] =&gt; (item=show route 5.5.5.5/32)\nok: [P2] =&gt; (item=show cef 5.5.5.5/32)\nTASK [5.5 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [P2] =&gt; (item=show isis route 5.5.5.5/32 detail) =&gt; msg:\n- - - 'L2 5.5.5.5/32 [30/115] Label: 16005, medium priority'\n- '   Installed Mar 05 13:26:28.810 for 00:01:00'\n- '     via 23.0.0.3, GigabitEthernet0/0/0/0, Label: 16005, P3, SRGB Base: 16000, Weight: 0'\n- '     src PE5.00-00, 5.5.5.5, prefix-SID index 5, R:0 N:1 P:0 E:0 V:0 L:0, Alg:0'\nok: [P2] =&gt; (item=show isis fast-reroute 5.5.5.5/32 detail) =&gt; msg:\n- - - 'L2 5.5.5.5/32 [30/115] Label: 16005, medium priority'\n- '   Installed Mar 05 13:26:28.810 for 00:01:01'\n- '     via 23.0.0.3, GigabitEthernet0/0/0/0, Label: 16005, P3, SRGB Base: 16000, Weight: 0'\n- '       Backup path: LFA, via 27.0.0.7, GigabitEthernet0/0/0/3, Label: 16005, P7, SRGB Base: 16000, Weight: 0, Metric: 120'\n- '       P: No, TM: 120, LC: No, NP: Yes, D: Yes, SRLG: Yes'\n- '     src PE5.00-00, 5.5.5.5, prefix-SID index 5, R:0 N:1 P:0 E:0 V:0 L:0, Alg:0'\nok: [P2] =&gt; (item=show route 5.5.5.5/32) =&gt; msg:\n- - - Routing entry for 5.5.5.5/32\n- '  Known via \"isis IGP\", distance 115, metric 30, labeled SR, type level-2'\n- '  Installed Mar  5 13:26:28.811 for 00:01:01'\n- '  Routing Descriptor Blocks'\n- '    23.0.0.3, from 5.5.5.5, via GigabitEthernet0/0/0/0, Protected'\n- '      Route metric is 30'\n- '    27.0.0.7, from 5.5.5.5, via GigabitEthernet0/0/0/3, Backup (Local-LFA)'\n- '      Route metric is 120'\n- '  No advertising protos.'\nok: [P2] =&gt; (item=show cef 5.5.5.5/32) =&gt; msg:\n- - - 5.5.5.5/32, version 4231, labeled SR, internal 0x1000001 0x8310 (ptr 0xe831808) [1], 0x600 (0xe1a0c80), 0xa28 (0xf656a48)\n- ' Updated Mar  5 13:26:28.819 '\n- ' remote adjacency to GigabitEthernet0/0/0/0'\n- ' Prefix Len 32, traffic index 0, precedence n/a, priority 1'\n- '  gateway array (0xe00a3b8) reference count 9, flags 0x500068, source rib (7), 1 backups'\n- '                [4 type 5 flags 0x8401 (0xec237c8) ext 0x0 (0x0)]'\n- '  LW-LDI[type=5, refc=3, ptr=0xe1a0c80, sh-ldi=0xec237c8]'\n- '  gateway array update type-time 1 Mar  5 13:26:28.816'\n- ' LDI Update time Mar  5 13:26:28.816'\n- ' LW-LDI-TS Mar  5 13:26:28.820'\n- '   via 23.0.0.3/32, GigabitEthernet0/0/0/0, 14 dependencies, weight 0, class 0, protected [flags 0x400]'\n- '    path-idx 0 bkup-idx 1 NHID 0x0 [0xddb6810 0x0]'\n- '    next hop 23.0.0.3/32'\n- '     local label 16005      labels imposed {16005}'\n- '   via 27.0.0.7/32, GigabitEthernet0/0/0/3, 12 dependencies, weight 0, class 0, backup (Local-LFA) [flags 0x300]'\n- '    path-idx 1 NHID 0x0 [0xf399970 0x0]'\n- '    next hop 27.0.0.7/32'\n- '    remote adjacency'\n- '     local label 16005      labels imposed {16005}'\n- ''\n- '    Load distribution: 0 (refcount 4)'\n- ''\n- '    Hash  OK  Interface                 Address'\n- '    0     Y   GigabitEthernet0/0/0/0    remote'\nTASK [5.6 RENDER AND DISPLAY THE ZERO SEGMENT TI-LFA REVERSAL CONFIGURATION] ***\nok: [P2] =&gt; msg:\n- 'template: zs_tilfa_revert_p2.j2'\n- - router isis IGP\n- ' interface GigabitEthernet0/0/0/1'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- ' interface GigabitEthernet0/0/0/3'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P6] =&gt; msg:\n- 'template: zs_tilfa_revert_p6.j2'\n- - router isis IGP\n- ' interface GigabitEthernet0/0/0/1'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P7] =&gt; msg:\n- 'template: zs_tilfa_revert_p7.j2'\n- - router isis IGP\n- ' interface GigabitEthernet0/0/0/3'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nTASK [5.7 RENDER AND SAVE THE ZERO SEGMENT TI-LFA REVARSAL CONFIGURATION] ******\nchanged: [P2]\nchanged: [P6]\nchanged: [P7]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [P2]\nTASK [5.8 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [P6] =&gt; output.dest: xrcfg/P6.zs_tilfa_revert.xrcfg\nok: [P7] =&gt; output.dest: xrcfg/P7.zs_tilfa_revert.xrcfg\nok: [P2] =&gt; output.dest: xrcfg/P2.zs_tilfa_revert.xrcfg\nTASK [5.9 RENDER AND REVERT ZERO SEGMENT TI-LFA SCENARIO CHANGES] **************\nchanged: [P6]\nchanged: [P7]\nchanged: [P2]\n</code></pre>"},{"location":"all_inclusive_play/#single-segment-ti-lfa","title":"Single Segment TI-LFA","text":"Single Segment TI-LFA <pre><code>PLAY [6. CISCO XRV9K SR WITH TI-LFA LAB PLAYBOOK - SINGLE SEGMENT TI-LFA] ******\nTASK [6.0 RENDER AND DISPLAY THE SINGLE SEGMENT TI-LFA CONFIGURATION] **********\nok: [P7] =&gt; msg:\n- 'template: ss_tilfa_p7.j2'\n- - router isis IGP\n- ' interface GigabitEthernet0/0/0/1'\n- '  shutdown'\n- ' !'\n- ' interface GigabitEthernet0/0/0/3'\n- '  shutdown'\n- ' !'\n- ' interface GigabitEthernet0/0/0/4'\n- '  shutdown'\n- ' !'\n- '!'\n- ''\n- ''\nTASK [6.1 RENDER AND SAVE THE SINGLE SEGMENT TI-LFA CONFIGURATION] *************\nchanged: [P7]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [P2]\nTASK [6.2 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [P7] =&gt; output.dest: xrcfg/P7.ss_tilfa.xrcfg\nTASK [6.3 RENDER AND APPLY THE SINGLE SEGMENT TI-LFA CONFIGURATION] ************\nchanged: [P7]\nPausing for 60 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 minutes PAUSE FOR CONVERGENCE] *****************************************\nok: [P2]\nTASK [6.4 RUN COMMANDS TO VERIFY SINGLE SEGMENT TI-LFA SCENARIO] ***************\nok: [P2] =&gt; (item=show isis route 5.5.5.5/32 detail)\nok: [P2] =&gt; (item=show isis fast-reroute 5.5.5.5/32 detail)\nok: [P2] =&gt; (item=show route 5.5.5.5/32)\nok: [P2] =&gt; (item=show cef 5.5.5.5/32)\nTASK [6.5 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [P2] =&gt; (item=show isis route 5.5.5.5/32 detail) =&gt; msg:\n- - - 'L2 5.5.5.5/32 [30/115] Label: 16005, medium priority'\n- '   Installed Mar 05 13:27:51.734 for 00:01:04'\n- '     via 23.0.0.3, GigabitEthernet0/0/0/0, Label: 16005, P3, SRGB Base: 16000, Weight: 0'\n- '     src PE5.00-00, 5.5.5.5, prefix-SID index 5, R:0 N:1 P:0 E:0 V:0 L:0, Alg:0'\nok: [P2] =&gt; (item=show isis fast-reroute 5.5.5.5/32 detail) =&gt; msg:\n- - - 'L2 5.5.5.5/32 [30/115] Label: 16005, medium priority'\n- '   Installed Mar 05 13:27:51.734 for 00:01:05'\n- '     via 23.0.0.3, GigabitEthernet0/0/0/0, Label: 16005, P3, SRGB Base: 16000, Weight: 0'\n- '       Backup path: TI-LFA (link), via 26.0.0.6, GigabitEthernet0/0/0/1 P6, SRGB Base: 16000, Weight: 0, Metric: 50'\n- '         P node: P8.00 [8.8.8.8], Label: 16008'\n- '         Prefix label: 16005'\n- '         Backup-src: PE5.00'\n- '       P: No, TM: 50, LC: No, NP: No, D: No, SRLG: Yes'\n- '     src PE5.00-00, 5.5.5.5, prefix-SID index 5, R:0 N:1 P:0 E:0 V:0 L:0, Alg:0'\nok: [P2] =&gt; (item=show route 5.5.5.5/32) =&gt; msg:\n- - - Routing entry for 5.5.5.5/32\n- '  Known via \"isis IGP\", distance 115, metric 30, labeled SR, type level-2'\n- '  Installed Mar  5 13:27:51.735 for 00:01:05'\n- '  Routing Descriptor Blocks'\n- '    23.0.0.3, from 5.5.5.5, via GigabitEthernet0/0/0/0, Protected'\n- '      Route metric is 30'\n- '    26.0.0.6, from 5.5.5.5, via GigabitEthernet0/0/0/1, Backup (TI-LFA)'\n- '      Repair Node(s): 8.8.8.8'\n- '      Route metric is 50'\n- '  No advertising protos.'\nok: [P2] =&gt; (item=show cef 5.5.5.5/32) =&gt; msg:\n- - - 5.5.5.5/32, version 4333, labeled SR, internal 0x1000001 0x8310 (ptr 0xe831808) [1], 0x600 (0xe1a0c80), 0xa28 (0xf656520)\n- ' Updated Mar  5 13:27:51.742 '\n- ' remote adjacency to GigabitEthernet0/0/0/0'\n- ' Prefix Len 32, traffic index 0, precedence n/a, priority 1'\n- '  gateway array (0xe00bee8) reference count 6, flags 0x500068, source rib (7), 1 backups'\n- '                [3 type 5 flags 0x8401 (0xec236a8) ext 0x0 (0x0)]'\n- '  LW-LDI[type=5, refc=3, ptr=0xe1a0c80, sh-ldi=0xec236a8]'\n- '  gateway array update type-time 1 Mar  5 13:27:51.742'\n- ' LDI Update time Mar  5 13:27:51.742'\n- ' LW-LDI-TS Mar  5 13:27:51.742'\n- '   via 23.0.0.3/32, GigabitEthernet0/0/0/0, 14 dependencies, weight 0, class 0, protected [flags 0x400]'\n- '    path-idx 0 bkup-idx 1 NHID 0x0 [0xddb6540 0x0]'\n- '    next hop 23.0.0.3/32'\n- '     local label 16005      labels imposed {16005}'\n- '   via 26.0.0.6/32, GigabitEthernet0/0/0/1, 11 dependencies, weight 0, class 0, backup (TI-LFA) [flags 0xb00]'\n- '    path-idx 1 NHID 0x0 [0xf399fb0 0x0]'\n- '    next hop 26.0.0.6/32, Repair Node(s): 8.8.8.8'\n- '    remote adjacency'\n- '     local label 16005      labels imposed {16008 16005}'\n- ''\n- '    Load distribution: 0 (refcount 3)'\n- ''\n- '    Hash  OK  Interface                 Address'\n- '    0     Y   GigabitEthernet0/0/0/0    remote'\n</code></pre>"},{"location":"all_inclusive_play/#double-segment-ti-lfa","title":"Double Segment TI-LFA","text":"Double Segment TI-LFA <pre><code>PLAY [7. CISCO XRV9K SR WITH TI-LFA LAB PLAYBOOK - DOUBLE SEGMENT TI-LFA] ******\nTASK [7.0 RENDER AND DISPLAY THE DOUBLE SEGMENT TI-LFA CONFIGURATION] **********\nok: [P4] =&gt; msg:\n- 'template: ds_tilfa.j2'\n- - router isis IGP\n- ' interface GigabitEthernet0/0/0/1'\n- '  address-family ipv4 unicast'\n- '   metric 100'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P8] =&gt; msg:\n- 'template: ds_tilfa.j2'\n- - router isis IGP\n- ' interface GigabitEthernet0/0/0/1'\n- '  address-family ipv4 unicast'\n- '   metric 100'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nTASK [7.1 RENDER AND SAVE THE DOUBLE SEGMENT TI-LFA CONFIGURATION] *************\nchanged: [P4]\nchanged: [P8]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [P2]\nTASK [7.2 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [P4] =&gt; output.dest: xrcfg/P4.ds_tilfa.xrcfg\nok: [P8] =&gt; output.dest: xrcfg/P8.ds_tilfa.xrcfg\nTASK [7.3 RENDER AND APPLY THE DOUBLE SEGMENT TI-LFA CONFIGURATION] ************\nchanged: [P8]\nchanged: [P4]\nPausing for 60 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 minutes PAUSE FOR CONVERGENCE] *****************************************\nok: [P2]\nTASK [7.4 RUN COMMANDS TO VERIFY DOUBLE SEGMENT TI-LFA SCENARIO...(A)] *********\nok: [P8] =&gt; (item=traceroute sr-mpls 5.5.5.5/32)\nok: [P8] =&gt; (item=show isis adjacency Gi0/0/0/1 detail)\nTASK [7.5 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [P8] =&gt; (item=traceroute sr-mpls 5.5.5.5/32) =&gt; msg:\n- - - Tracing MPLS Label Switched Path to 5.5.5.5/32, timeout is 2 seconds\n- ''\n- 'Codes: ''!'' - success, ''Q'' - request not sent, ''.'' - timeout,'\n- '  ''L'' - labeled output interface, ''B'' - unlabeled output interface, '\n- '  ''D'' - DS Map mismatch, ''F'' - no FEC mapping, ''f'' - FEC mismatch,'\n- '  ''M'' - malformed request, ''m'' - unsupported tlvs, ''N'' - no rx label, '\n- '  ''P'' - no rx intf label prot, ''p'' - premature termination of LSP, '\n- '  ''R'' - transit router, ''I'' - unknown upstream index,'\n- '  ''X'' - unknown return code, ''x'' - return code 0'\n- ''\n- Type escape sequence to abort.\n- ''\n- '  0 78.0.0.8 MRU 1500 [Labels: 16005 Exp: 0]'\n- 'L 1 78.0.0.7 MRU 1500 [Labels: 16005 Exp: 0] 17 ms'\n- 'L 2 67.0.0.6 MRU 1500 [Labels: 16005 Exp: 0] 19 ms'\n- 'L 3 26.0.0.2 MRU 1500 [Labels: 16005 Exp: 0] 15 ms'\n- 'L 4 23.0.0.3 MRU 1500 [Labels: 16005 Exp: 0] 22 ms'\n- 'L 5 34.0.0.4 MRU 1500 [Labels: implicit-null Exp: 0] 15 ms'\n- '! 6 45.0.0.5 17 ms'\nok: [P8] =&gt; (item=show isis adjacency Gi0/0/0/1 detail) =&gt; msg:\n- - - 'IS-IS IGP Level-2 adjacencies:'\n- System Id      Interface                SNPA           State Hold Changed  NSF IPv4 IPv6\n- '                                                                               BFD  BFD '\n- P4             Gi0/0/0/1                *PtoP*         Up    28   00:13:32 Yes None None\n- '  Area Address:           49'\n- '  Neighbor IPv4 Address:  48.0.0.4*'\n- '  Adjacency SID:          24020 (protected)'\n- '   Backup label stack:    [16004]'\n- '   Backup stack size:     1'\n- '   Backup interface:      Gi0/0/0/2'\n- '   Backup nexthop:        78.0.0.7'\n- '   Backup node address:   4.4.4.4'\n- '  Non-FRR Adjacency SID:  24021'\n- '  Topology:               IPv4 Unicast'\n- '  BFD Status:             BFD Not Required, Neighbor Useable'\n- ''\n- 'Total adjacency count: 1'\nTASK [7.6 RUN COMMANDS TO VERIFY DOUBLE SEGMENT TI-LFA SCENARIO...(B)] *********\nok: [P2] =&gt; (item=show isis fast-reroute 5.5.5.5/32 detail)\nok: [P2] =&gt; (item=show cef 5.5.5.5/32)\nTASK [7.7 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [P2] =&gt; (item=show isis fast-reroute 5.5.5.5/32 detail) =&gt; msg:\n- - - 'L2 5.5.5.5/32 [30/115] Label: 16005, medium priority'\n- '   Installed Mar 05 13:29:11.309 for 00:01:03'\n- '     via 23.0.0.3, GigabitEthernet0/0/0/0, Label: 16005, P3, SRGB Base: 16000, Weight: 0'\n- '       Backup path: TI-LFA (link), via 26.0.0.6, GigabitEthernet0/0/0/1 P6, SRGB Base: 16000, Weight: 0, Metric: 140'\n- '         P node: P8.00 [8.8.8.8], Label: 16008'\n- '         Q node: P4.00 [4.4.4.4], Label: 24021'\n- '         Prefix label: 16005'\n- '         Backup-src: PE5.00'\n- '       P: No, TM: 140, LC: No, NP: No, D: No, SRLG: Yes'\n- '     src PE5.00-00, 5.5.5.5, prefix-SID index 5, R:0 N:1 P:0 E:0 V:0 L:0, Alg:0'\nok: [P2] =&gt; (item=show cef 5.5.5.5/32) =&gt; msg:\n- - - 5.5.5.5/32, version 4372, labeled SR, internal 0x1000001 0x8310 (ptr 0xe831808) [1], 0x600 (0xe1a0c80), 0xa28 (0xf6566d8)\n- ' Updated Mar  5 13:29:11.316 '\n- ' remote adjacency to GigabitEthernet0/0/0/0'\n- ' Prefix Len 32, traffic index 0, precedence n/a, priority 1'\n- '  gateway array (0xe008970) reference count 6, flags 0x500068, source rib (7), 1 backups'\n- '                [3 type 5 flags 0x8401 (0xec23d68) ext 0x0 (0x0)]'\n- '  LW-LDI[type=5, refc=3, ptr=0xe1a0c80, sh-ldi=0xec23d68]'\n- '  gateway array update type-time 1 Mar  5 13:29:11.316'\n- ' LDI Update time Mar  5 13:29:11.316'\n- ' LW-LDI-TS Mar  5 13:29:11.316'\n- '   via 23.0.0.3/32, GigabitEthernet0/0/0/0, 10 dependencies, weight 0, class 0, protected [flags 0x400]'\n- '    path-idx 0 bkup-idx 1 NHID 0x0 [0xddb6540 0x0]'\n- '    next hop 23.0.0.3/32'\n- '     local label 16005      labels imposed {16005}'\n- '   via 26.0.0.6/32, GigabitEthernet0/0/0/1, 11 dependencies, weight 0, class 0, backup (TI-LFA) [flags 0xb00]'\n- '    path-idx 1 NHID 0x0 [0xf399fb0 0x0]'\n- '    next hop 26.0.0.6/32, Repair Node(s): 8.8.8.8, 4.4.4.4'\n- '    remote adjacency'\n- '     local label 16005      labels imposed {16008 24021 16005}'\n- ''\n- '    Load distribution: 0 (refcount 3)'\n- ''\n- '    Hash  OK  Interface                 Address'\n- '    0     Y   GigabitEthernet0/0/0/0    remote'\nTASK [7.8 RENDER AND DISPLAY DOUBLE SEGMENT TI-LFA REVERSAL CONFIGURATION] *****\nok: [P4] =&gt; msg:\n- 'template: ds_tilfa_revert.j2'\n- - router isis IGP\n- ' interface GigabitEthernet0/0/0/1'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P8] =&gt; msg:\n- 'template: ds_tilfa_revert.j2'\n- - router isis IGP\n- ' interface GigabitEthernet0/0/0/1'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nTASK [7.9 RENDER AND SAVE THE DOUBLE SEGMENT TI-LFA REVERSAL CONFIGURATION] ****\nchanged: [P8]\nchanged: [P4]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [P2]\nTASK [7.10 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [P8] =&gt; output.dest: xrcfg/P8.ds_tilfa_revert.xrcfg\nok: [P4] =&gt; output.dest: xrcfg/P4.ds_tilfa_revert.xrcfg\nTASK [7.11 RENDER AND APPLY THE DOUBLE SEGMENT TI-LFA REVERSAL CONFIGURATION] ***\nchanged: [P4]\nchanged: [P8]\n</code></pre>"},{"location":"all_inclusive_play/#microloop-avoidance","title":"Microloop Avoidance","text":"Microloop Avoidance <pre><code>PLAY [8. CISCO XRV9K SR WITH TI-LFA LAB PLAYBOOK - MICROLOOP AVOIDANCE] ********\nTASK [8.0 RENDER AND DISPLAY THE PREPARATION CONFIGURATION] ********************\nok: [P2] =&gt; msg:\n- 'template: microloop_avoidance_p2.j2'\n- - router isis IGP\n- ' interface GigabitEthernet0/0/0/0'\n- '  address-family ipv4 unicast'\n- '   metric 100'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P8] =&gt; msg:\n- 'template: microloop_avoidance_p8.j2'\n- - router isis IGP\n- ' interface GigabitEthernet0/0/0/1'\n- '  shutdown'\n- ' !'\n- '!'\n- ''\n- ''\nTASK [8.1 RENDER AND SAVE THE PREPARATION CONFIGURATION] ***********************\nchanged: [P2]\nchanged: [P8]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [P2]\nTASK [8.2 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [P2] =&gt; output.dest: xrcfg/P2.mlaprep.xrcfg\nok: [P8] =&gt; output.dest: xrcfg/P8.mlaprep.xrcfg\nTASK [8.3 RENDER AND APPLY THE PREPARATION CONFIGURATION] **********************\nchanged: [P2]\nchanged: [P8]\nPausing for 60 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 minutes PAUSE FOR CONVERGENCE] *****************************************\nok: [P2]\nTASK [8.4 RUN COMMANDS TO CHECK PATH to PE5 IS VIA P3] *************************\nok: [P2] =&gt; (item=show isis fast-reroute 5.5.5.5/32 detail)\nok: [P2] =&gt; (item=show route 5.5.5.5/32)\nok: [P2] =&gt; (item=show cef 5.5.5.5/32)\nTASK [8.5 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [P2] =&gt; (item=show isis fast-reroute 5.5.5.5/32 detail) =&gt; msg:\n- - - 'L2 5.5.5.5/32 [120/115] Label: 16005, medium priority'\n- '   Installed Mar 05 13:30:33.226 for 00:01:01'\n- '     via 23.0.0.3, GigabitEthernet0/0/0/0, Label: 16005, P3, SRGB Base: 16000, Weight: 0'\n- '       No FRR backup'\n- '     src PE5.00-00, 5.5.5.5, prefix-SID index 5, R:0 N:1 P:0 E:0 V:0 L:0, Alg:0'\nok: [P2] =&gt; (item=show route 5.5.5.5/32) =&gt; msg:\n- - - Routing entry for 5.5.5.5/32\n- '  Known via \"isis IGP\", distance 115, metric 120, labeled SR, type level-2'\n- '  Installed Mar  5 13:30:33.226 for 00:01:02'\n- '  Routing Descriptor Blocks'\n- '    23.0.0.3, from 5.5.5.5, via GigabitEthernet0/0/0/0'\n- '      Route metric is 120'\n- '  No advertising protos.'\nok: [P2] =&gt; (item=show cef 5.5.5.5/32) =&gt; msg:\n- - - 5.5.5.5/32, version 4433, labeled SR, internal 0x1000001 0x8310 (ptr 0xe831138) [1], 0x600 (0xe1a0020), 0xa28 (0xebe0f58)\n- ' Updated Mar  5 13:30:33.231 '\n- ' remote adjacency to GigabitEthernet0/0/0/0'\n- ' Prefix Len 32, traffic index 0, precedence n/a, priority 1'\n- '  gateway array (0xe00aaf8) reference count 6, flags 0x68, source rib (7), 1 backups'\n- '                [3 type 5 flags 0x8401 (0xec24e48) ext 0x0 (0x0)]'\n- '  LW-LDI[type=5, refc=3, ptr=0xe1a0020, sh-ldi=0xec24e48]'\n- '  gateway array update type-time 1 Mar  5 13:30:33.230'\n- ' LDI Update time Mar  5 13:30:33.230'\n- ' LW-LDI-TS Mar  5 13:30:33.231'\n- '   via 23.0.0.3/32, GigabitEthernet0/0/0/0, 8 dependencies, weight 0, class 0 [flags 0x0]'\n- '    path-idx 0 NHID 0x0 [0xf399f10 0x0]'\n- '    next hop 23.0.0.3/32'\n- '    remote adjacency'\n- '     local label 16005      labels imposed {16005}'\n- ''\n- '    Load distribution: 0 (refcount 3)'\n- ''\n- '    Hash  OK  Interface                 Address'\n- '    0     Y   GigabitEthernet0/0/0/0    remote'\nTASK [8.6 RENDER AND DISPLAY THE MICROLOOP AVOIDANCE CONFIGURATION] ************\nok: [P2] =&gt; msg:\n- 'template: microloop_avoidance_p2_enable.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  microloop avoidance segment-routing'\n- '  microloop avoidance rib-update-delay 60000'\n- ' !'\n- '!'\n- ''\n- ''\nTASK [8.7 RENDER AND SAVE THE MICROLOOP AVOIDANCE CONFIGURATION] ***************\nchanged: [P2]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [P2]\nTASK [8.8 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [P2] =&gt; output.dest: xrcfg/P2.mla.xrcfg\nTASK [8.9 RENDER AND APPLY THE MICROLOOP AVOIDANCE CONFIGURATION] **************\nchanged: [P2]\nPausing for 60 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 minutes PAUSE FOR CONVERGENCE] *****************************************\nok: [P2]\nTASK [8.10 RENDER AND DISPLAY THE MICROLOOP TRIGGER CONFIGURATION] *************\nok: [P8] =&gt; msg:\n- 'template: microloop_avoidance_p8_trigger.j2'\n- - router isis IGP\n- ' interface GigabitEthernet0/0/0/1'\n- '  no shutdown'\n- ' !'\n- '!'\n- ''\n- ''\nTASK [8.11 RENDER AND SAVE THE MICROLOOP TRIGGER CONFIGURATION] ****************\nchanged: [P8]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [P2]\nTASK [8.12 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [P8] =&gt; output.dest: xrcfg/P8.mlatrgr.xrcfg\nTASK [8.13 RENDER AND APPLY THE MICROLOOP TRIGGER CONFIGURATION] ***************\nchanged: [P8]\nPausing for 15 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [15 seconds PAUSE FOR CONVERGENCE] ****************************************\nok: [P2]\nTASK [8.14 RUN COMMANDS TO VERIFY MICROLOOP AVOIDANCE] *************************\nok: [P2] =&gt; (item=show isis protocol | utility egrep -A2 Micro)\nok: [P2] =&gt; (item=show isis fast-reroute 5.5.5.5/32 detail)\nok: [P2] =&gt; (item=show route 5.5.5.5/32)\nok: [P2] =&gt; (item=show route 5.5.5.5/32 detail)\nok: [P2] =&gt; (item=show cef 5.5.5.5/32)\nTASK [8.15 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [P2] =&gt; (item=show isis protocol | utility egrep -A2 Micro) =&gt; msg:\n- - - 'Microloop avoidance: Enabled'\n- '          Configuration: Type: Segment routing, RIB update delay: 60000 msec'\n- '          State: Active, Duration: 15222 ms, Event Link up, Near: P8.00 Far: P4.00'\nok: [P2] =&gt; (item=show isis fast-reroute 5.5.5.5/32 detail) =&gt; msg:\n- - - 'L2 5.5.5.5/32 [50/115] Label: 16005, medium priority'\n- '   Installed Mar 05 13:32:57.267 for 00:00:16'\n- '     via 26.0.0.6, GigabitEthernet0/0/0/1, P6, SRGB Base: 16000, Weight: 0'\n- '       No FRR backup'\n- '     exp 26.0.0.6, GigabitEthernet0/0/0/1, P6, SRGB Base: 16000, Weight: 0'\n- '       via explicit path'\n- '         P node: P8.00 [8.8.8.8], Label: 16008'\n- '         Q node: P4.00 [4.4.4.4], Label: 24021'\n- '         Prefix label: 16005'\n- '     src PE5.00-00, 5.5.5.5, prefix-SID index 5, R:0 N:1 P:0 E:0 V:0 L:0, Alg:0'\nok: [P2] =&gt; (item=show route 5.5.5.5/32) =&gt; msg:\n- - - Routing entry for 5.5.5.5/32\n- '  Known via \"isis IGP\", distance 115, metric 50, labeled SR, type level-2'\n- '  Installed Mar  5 13:32:57.267 for 00:00:16'\n- '  Routing Descriptor Blocks'\n- '    26.0.0.6, from 5.5.5.5, via GigabitEthernet0/0/0/1'\n- '      Route metric is 50'\n- '  No advertising protos.'\nok: [P2] =&gt; (item=show route 5.5.5.5/32 detail) =&gt; msg:\n- - - Routing entry for 5.5.5.5/32\n- '  Known via \"isis IGP\", distance 115, metric 50, labeled SR, type level-2'\n- '  Installed Mar  5 13:32:57.267 for 00:00:17'\n- '  Routing Descriptor Blocks'\n- '    26.0.0.6, from 5.5.5.5, via GigabitEthernet0/0/0/1'\n- '      Route metric is 50'\n- '      Labels: 0x3e88 0x5dd5 0x3e85 (16008 24021 16005)'\n- '      Tunnel ID: None'\n- '      Binding Label: None'\n- '      Extended communities count: 0'\n- \"      Path id:1\\t      Path ref count:0\"\n- '      NHID:0xc(Ref:16)'\n- '  Route version is 0x34 (52)'\n- '  Local Label: 0x3e85 (16005)'\n- '  IP Precedence: Not Set'\n- '  QoS Group ID: Not Set'\n- '  Flow-tag: Not Set'\n- '  Fwd-class: Not Set'\n- '  Route Priority: RIB_PRIORITY_NON_RECURSIVE_MEDIUM (7) SVD Type RIB_SVD_TYPE_LOCAL'\n- '  Download Priority 1, Download Version 4449'\n- '  No advertising protos.'\nok: [P2] =&gt; (item=show cef 5.5.5.5/32) =&gt; msg:\n- - - 5.5.5.5/32, version 4449, labeled SR, internal 0x1000001 0x8310 (ptr 0xe831138) [1], 0x600 (0xe1a0020), 0xa28 (0xebe04b8)\n- ' Updated Mar  5 13:32:57.279 '\n- ' remote adjacency to GigabitEthernet0/0/0/1'\n- ' Prefix Len 32, traffic index 0, precedence n/a, priority 1'\n- '  gateway array (0xe00c0b8) reference count 15, flags 0x68, source rib (7), 1 backups'\n- '                [6 type 5 flags 0x8401 (0xec233a8) ext 0x0 (0x0)]'\n- '  LW-LDI[type=5, refc=3, ptr=0xe1a0020, sh-ldi=0xec233a8]'\n- '  gateway array update type-time 1 Mar  5 13:30:31.322'\n- ' LDI Update time Mar  5 13:30:31.322'\n- ' LW-LDI-TS Mar  5 13:32:57.279'\n- '   via 26.0.0.6/32, GigabitEthernet0/0/0/1, 8 dependencies, weight 0, class 0 [flags 0x0]'\n- '    path-idx 0 NHID 0x0 [0xf399fb0 0x0]'\n- '    next hop 26.0.0.6/32'\n- '    remote adjacency'\n- '     local label 16005      labels imposed {16008 24021 16005}'\n- ''\n- '    Load distribution: 0 (refcount 6)'\n- ''\n- '    Hash  OK  Interface                 Address'\n- '    0     Y   GigabitEthernet0/0/0/1    remote'\nTASK [8.16 RENDER AND DISPLAY THE RESTORATION CONFIGURATION] *******************\nok: [P2] =&gt; msg:\n- 'template: microloop_avoidance_p2_restore.j2'\n- - router isis IGP\n- ' interface GigabitEthernet0/0/0/0'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P7] =&gt; msg:\n- 'template: microloop_avoidance_p7_restore.j2'\n- - router isis IGP\n- ' interface GigabitEthernet0/0/0/1'\n- '  no shutdown'\n- ' !'\n- ' interface GigabitEthernet0/0/0/3'\n- '  no shutdown'\n- ' !'\n- ' interface GigabitEthernet0/0/0/4'\n- '  no shutdown'\n- ' !'\n- '!'\n- ''\n- ''\nTASK [8.17 RENDER AND SAVE THE RESTORATION CONFIGURATION] **********************\nchanged: [P2]\nchanged: [P7]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [P2]\nTASK [8.18 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [P2] =&gt; output.dest: xrcfg/P2.mlarestore.xrcfg\nok: [P7] =&gt; output.dest: xrcfg/P7.mlarestore.xrcfg\nTASK [8.19 RENDER AND APPLY THE RESTORATION CONFIGURATION] *********************\nchanged: [P2]\nchanged: [P7]\n</code></pre>"},{"location":"all_inclusive_play/#mpls-traffic-engineering","title":"MPLS Traffic-Engineering","text":"<pre><code>PLAY [9. CISCO XRV9K SR WITH TI-LFA LAB PLAYBOOK - MPLS TRAFFIC-ENGINEERING] ***\nTASK [9.0 RENDER AND DISPLAY THE MPLS TRAFFIC-ENGINEERING CONFIGURATION] *******\nok: [P3] =&gt; msg:\n- 'template: mpls_traff_eng.j2'\n- - ipv4 unnumbered mpls traffic-eng Loopback0\n- router isis IGP address-family ipv4 unicast mpls traffic-eng router-id Loopback0\n- mpls traffic-eng\n- '!'\n- ''\n- ''\nok: [PE1] =&gt; msg:\n- 'template: mpls_traff_eng.j2'\n- - ipv4 unnumbered mpls traffic-eng Loopback0\n- router isis IGP address-family ipv4 unicast mpls traffic-eng router-id Loopback0\n- mpls traffic-eng\n- '!'\n- ''\n- ''\nok: [P2] =&gt; msg:\n- 'template: mpls_traff_eng.j2'\n- - ipv4 unnumbered mpls traffic-eng Loopback0\n- router isis IGP address-family ipv4 unicast mpls traffic-eng router-id Loopback0\n- mpls traffic-eng\n- '!'\n- ''\n- ''\nok: [PE5] =&gt; msg:\n- 'template: mpls_traff_eng.j2'\n- - ipv4 unnumbered mpls traffic-eng Loopback0\n- router isis IGP address-family ipv4 unicast mpls traffic-eng router-id Loopback0\n- mpls traffic-eng\n- '!'\n- ''\n- ''\nok: [P7] =&gt; msg:\n- 'template: mpls_traff_eng.j2'\n- - ipv4 unnumbered mpls traffic-eng Loopback0\n- router isis IGP address-family ipv4 unicast mpls traffic-eng router-id Loopback0\n- mpls traffic-eng\n- '!'\n- ''\n- ''\nok: [P4] =&gt; msg:\n- 'template: mpls_traff_eng.j2'\n- - ipv4 unnumbered mpls traffic-eng Loopback0\n- router isis IGP address-family ipv4 unicast mpls traffic-eng router-id Loopback0\n- mpls traffic-eng\n- '!'\n- ''\n- ''\nok: [P6] =&gt; msg:\n- 'template: mpls_traff_eng.j2'\n- - ipv4 unnumbered mpls traffic-eng Loopback0\n- router isis IGP address-family ipv4 unicast mpls traffic-eng router-id Loopback0\n- mpls traffic-eng\n- '!'\n- ''\n- ''\nok: [P8] =&gt; msg:\n- 'template: mpls_traff_eng.j2'\n- - ipv4 unnumbered mpls traffic-eng Loopback0\n- router isis IGP address-family ipv4 unicast mpls traffic-eng router-id Loopback0\n- mpls traffic-eng\n- '!'\n- ''\n- ''\nTASK [9.1 RENDER AND SAVE THE MPLS TRAFFIC-ENGINEERING CONFIGURATION] **********\nchanged: [P2]\nchanged: [P3]\nchanged: [P4]\nchanged: [P7]\nchanged: [P8]\nchanged: [P6]\nchanged: [PE1]\nchanged: [PE5]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [PE1]\nTASK [9.2 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ******************\nok: [P2] =&gt; output.dest: xrcfg/P2.mpls_traffic_eng.xrcfg\nok: [PE1] =&gt; output.dest: xrcfg/PE1.mpls_traffic_eng.xrcfg\nok: [P4] =&gt; output.dest: xrcfg/P4.mpls_traffic_eng.xrcfg\nok: [P6] =&gt; output.dest: xrcfg/P6.mpls_traffic_eng.xrcfg\nok: [P8] =&gt; output.dest: xrcfg/P8.mpls_traffic_eng.xrcfg\nok: [P7] =&gt; output.dest: xrcfg/P7.mpls_traffic_eng.xrcfg\nok: [P3] =&gt; output.dest: xrcfg/P3.mpls_traffic_eng.xrcfg\nok: [PE5] =&gt; output.dest: xrcfg/PE5.mpls_traffic_eng.xrcfg\nTASK [9.3 RENDER AND APPLY THE MPLS TRAFFIC-ENGINEERING CONFIGURATION] *********\nchanged: [PE1]\nchanged: [P6]\nchanged: [P8]\nchanged: [P4]\nchanged: [P2]\nchanged: [P7]\nchanged: [PE5]\nchanged: [P3]\n</code></pre>"},{"location":"all_inclusive_play/#ti-lfa-node-srlg-preparation","title":"TI-LFA Node + SRLG Preparation","text":"TI-LFA Node and SRLG Protection Topology <pre><code>PLAY [10. CISCO XRV9K SR WITH TI-LFA LAB PLAYBOOK - TI-LFA NODE + SRLG PROTECTION PREPARATION] ***\nTASK [10.0 RENDER AND DISPLAY THE TI-LFA NODE + SRLG PROTECTION PREPARATION CONFIGURATION] ***\nok: [P7] =&gt; msg:\n- 'template: tilfa_ns_prep_p7.j2'\n- - router isis IGP\n- ' interface GigabitEthernet0/0/0/0'\n- '  address-family ipv4 unicast'\n- '   metric 100'\n- '  !'\n- ' !'\n- ' interface GigabitEthernet0/0/0/4'\n- '  address-family ipv4 unicast'\n- '   metric 100'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P6] =&gt; msg:\n- 'template: tilfa_ns_prep_p6.j2'\n- - router isis IGP\n- ' interface GigabitEthernet0/0/0/0'\n- '  address-family ipv4 unicast'\n- '   metric 100'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P4] =&gt; msg:\n- 'template: tilfa_ns_prep_p4.j2'\n- - router isis IGP\n- ' interface GigabitEthernet0/0/0/4'\n- '  address-family ipv4 unicast'\n- '   metric 100'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P8] =&gt; msg:\n- 'template: tilfa_ns_prep_p8.j2'\n- - router isis IGP\n- ' interface GigabitEthernet0/0/0/1'\n- '  shutdown'\n- ' !'\n- ' interface GigabitEthernet0/0/0/2'\n- '  shutdown'\n- ' !'\n- '!'\n- ''\n- ''\nTASK [10.1 RENDER AND SAVE THE TI-LFA NODE + SRLG PROTECTION PREPARATION CONFIGURATION] ***\nchanged: [P4]\nchanged: [P6]\nchanged: [P7]\nchanged: [P8]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [P4]\nTASK [10.2 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [P4] =&gt; output.dest: xrcfg/P4.tilfa_ns_prep.xrcfg\nok: [P6] =&gt; output.dest: xrcfg/P6.tilfa_ns_prep.xrcfg\nok: [P8] =&gt; output.dest: xrcfg/P8.tilfa_ns_prep.xrcfg\nok: [P7] =&gt; output.dest: xrcfg/P7.tilfa_ns_prep.xrcfg\nTASK [10.3 RENDER AND APPLY THE TI-LFA NODE + SRLG PROTECTION PREPARATION CONFIGURATION] ***\nchanged: [P4]\nchanged: [P6]\nchanged: [P8]\nchanged: [P7]\n</code></pre>"},{"location":"all_inclusive_play/#ti-lfa-node-protection","title":"TI-LFA Node Protection","text":"TI-LFA Node Protection <pre><code>PLAY [11. CISCO XRV9K SR WITH TI-LFA LAB PLAYBOOK - TI-LFA NODE PROTECTION] ****\nTASK [11.0 RENDER AND DISPLAY THE TI-LFA NODE PROTECTION CONFIGURATION] ********\nok: [P2] =&gt; msg:\n- 'template: tilfa_ns_node.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  fast-reroute per-prefix tiebreaker node-protecting index 200'\n- ' !'\n- '!'\n- ''\n- ''\nTASK [11.1 RENDER AND SAVE THE TI-LFA NODE PROTECTION CONFIGURATION] ***********\nchanged: [P2]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [P2]\nTASK [11.2 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [P2] =&gt; output.dest: xrcfg/P2.tilfa_ns_node.xrcfg\nTASK [11.3 RENDER AND APPLY THE TI-LFA NODE PROTECTION CONFIGURATION] **********\nchanged: [P2]\nPausing for 60 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 seconds PAUSE FOR CONVERGENCE] *****************************************\nok: [P2]\nTASK [11.4 RUN COMMANDS TO VERIFY TI-LFA NODE PROTECTION] **********************\nok: [P2] =&gt; (item=sh isis fast-reroute 5.5.5.5/32 detail)\nok: [P2] =&gt; (item=show cef 5.5.5.5/32)\nTASK [11.5 DISPLAY OUTPUT FOR THE COMMANDS RUN IN THE PREVIOUS TASK] ***********\nok: [P2] =&gt; (item=sh isis fast-reroute 5.5.5.5/32 detail) =&gt; msg:\n- - - 'L2 5.5.5.5/32 [30/115] Label: 16005, medium priority'\n- '   Installed Mar 05 13:34:17.063 for 00:00:44'\n- '     via 23.0.0.3, GigabitEthernet0/0/0/0, Label: 16005, P3, SRGB Base: 16000, Weight: 0'\n- '       Backup path: TI-LFA (node), via 27.0.0.7, GigabitEthernet0/0/0/3 P7, SRGB Base: 16000, Weight: 0, Metric: 120'\n- '         P node: P7.00 [7.7.7.7], Label: ImpNull'\n- '         Q node: P4.00 [4.4.4.4], Label: 24023'\n- '         Prefix label: 16005'\n- '         Backup-src: PE5.00'\n- '       P: No, TM: 120, LC: No, NP: Yes, D: No, SRLG: Yes'\n- '     src PE5.00-00, 5.5.5.5, prefix-SID index 5, R:0 N:1 P:0 E:0 V:0 L:0, Alg:0'\nok: [P2] =&gt; (item=show cef 5.5.5.5/32) =&gt; msg:\n- - - 5.5.5.5/32, version 4640, labeled SR, internal 0x1000001 0x8310 (ptr 0xe831138) [1], 0x600 (0xe19fde0), 0xa28 (0xf4b4288)\n- ' Updated Mar  5 13:34:17.067 '\n- ' remote adjacency to GigabitEthernet0/0/0/0'\n- ' Prefix Len 32, traffic index 0, precedence n/a, priority 1'\n- '  gateway array (0xe00c8e0) reference count 6, flags 0x500068, source rib (7), 1 backups'\n- '                [5 type 4 flags 0x8401 (0xec24d88) ext 0x0 (0x0)]'\n- '  LW-LDI[type=1, refc=1, ptr=0xe19fde0, sh-ldi=0xec24d88]'\n- '  gateway array update type-time 1 Mar  5 13:34:17.067'\n- ' LDI Update time Mar  5 13:34:17.069'\n- ' LW-LDI-TS Mar  5 13:34:17.069'\n- '   via 23.0.0.3/32, GigabitEthernet0/0/0/0, 14 dependencies, weight 0, class 0, protected [flags 0x400]'\n- '    path-idx 0 bkup-idx 1 NHID 0x0 [0xddb6f90 0xddb6f90]'\n- '    next hop 23.0.0.3/32'\n- '     local label 16005      labels imposed {16005}'\n- '   via 27.0.0.7/32, GigabitEthernet0/0/0/3, 16 dependencies, weight 0, class 0, backup (TI-LFA) [flags 0xb00]'\n- '    path-idx 1 NHID 0x0 [0xf399970 0x0]'\n- '    next hop 27.0.0.7/32, Repair Node(s): 7.7.7.7, 4.4.4.4'\n- '    remote adjacency'\n- '     local label 16005      labels imposed {ImplNull 24023 16005}'\n- ''\n- '    Load distribution: 0 (refcount 5)'\n- ''\n- '    Hash  OK  Interface                 Address'\n- '    0     Y   GigabitEthernet0/0/0/0    remote'\nTASK [11.6 RENDER AND DISPLAY THE TI-LFA NODE PROTECTION REVERSAL CONFIGURATION] ***\nok: [P2] =&gt; msg:\n- 'template: tilfa_ns_node_revert.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  no fast-reroute per-prefix tiebreaker node-protecting index 200'\n- ' !'\n- '!'\n- ''\n- ''\nTASK [11.7 RENDER AND SAVE THE TI-LFA NODE PROTECTION REVERSAL CONFIGURATION] ***\nchanged: [P2]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [P2]\nTASK [11.8 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [P2] =&gt; output.dest: xrcfg/P2.tilfa_ns_node_revert.xrcfg\nTASK [11.9 RENDER AND APPLY THE TI-LFA NODE PROTECTION REVERSAL CONFIGURATION] ***\nchanged: [P2]\n</code></pre>"},{"location":"all_inclusive_play/#ti-lfa-local-srlg-disjoint-protection","title":"TI-LFA Local SRLG Disjoint Protection","text":"TI-LFA Local SRLG Disjoint Protection <pre><code>PLAY [12. CISCO XRV9K SR WITH TI-LFA LAB PLAYBOOK - TI-LFA LOCAL SRLG-DISJOINT PROTECTION] ***\nTASK [12.0 RENDER AND DISPLAY THE TI-LFA LOCAL SRLG-DISJOINT PROTECTION CONFIGURATION] ***\nok: [P2] =&gt; msg:\n- 'template: tilfa_ns_local_srlg.j2'\n- - srlg\n- ' interface GigabitEthernet0/0/0/0'\n- '  name SRLG-100'\n- ' !'\n- ' interface GigabitEthernet0/0/0/3'\n- '  name SRLG-100'\n- ' !'\n- ' name SRLG-100 value 100'\n- '!'\n- router isis IGP\n- ' address-family ipv4 unicast'\n- '  fast-reroute per-prefix tiebreaker srlg-disjoint index 100'\n- ' !'\n- '!'\n- ''\n- ''\nTASK [12.1 RENDER AND SAVE THE TI-LFA LOCAL SRLG-DISJOINT PROTECTION CONFIGURATION] ***\nchanged: [P2]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [P2]\nTASK [12.2 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [P2] =&gt; output.dest: xrcfg/P2.tilfa_ns_local_srlg.xrcfg\nTASK [12.3 RENDER AND APPLY THE TI-LFA LOCAL SRLG-DISJOINT PROTECTION CONFIGURATION] ***\nchanged: [P2]\nPausing for 60 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 seconds PAUSE FOR CONVERGENCE] *****************************************\nok: [P2]\nTASK [12.4 RUN COMMANDS TO VERIFY TI-LFA LOCAL SRLG-DISJOINT PROTECTION] *******\nok: [P2] =&gt; (item=sh isis fast-reroute 5.5.5.5/32 detail)\nok: [P2] =&gt; (item=show cef 5.5.5.5/32)\nTASK [12.5 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [P2] =&gt; (item=sh isis fast-reroute 5.5.5.5/32 detail) =&gt; msg:\n- - - 'L2 5.5.5.5/32 [30/115] Label: 16005, medium priority'\n- '   Installed Mar 05 13:35:19.631 for 00:01:02'\n- '     via 23.0.0.3, GigabitEthernet0/0/0/0, Label: 16005, P3, SRGB Base: 16000, Weight: 0'\n- '       Backup path: TI-LFA (srlg), via 26.0.0.6, GigabitEthernet0/0/0/1 P6, SRGB Base: 16000, Weight: 0, Metric: 140'\n- '         P node: P6.00 [6.6.6.6], Label: ImpNull'\n- '         Q node: P7.00 [7.7.7.7], Label: 24023'\n- '         Prefix label: 16005'\n- '         Backup-src: PE5.00'\n- '       P: No, TM: 140, LC: No, NP: No, D: No, SRLG: Yes'\n- '     src PE5.00-00, 5.5.5.5, prefix-SID index 5, R:0 N:1 P:0 E:0 V:0 L:0, Alg:0'\nok: [P2] =&gt; (item=show cef 5.5.5.5/32) =&gt; msg:\n- - - 5.5.5.5/32, version 4674, labeled SR, internal 0x1000001 0x8310 (ptr 0xe831138) [1], 0x600 (0xe1a14f0), 0xa28 (0xf4b41d8)\n- ' Updated Mar  5 13:35:19.641 '\n- ' remote adjacency to GigabitEthernet0/0/0/0'\n- ' Prefix Len 32, traffic index 0, precedence n/a, priority 1'\n- '  gateway array (0xe00c7f8) reference count 6, flags 0x500068, source rib (7), 1 backups'\n- '                [5 type 4 flags 0x8401 (0xec25808) ext 0x0 (0x0)]'\n- '  LW-LDI[type=1, refc=1, ptr=0xe1a14f0, sh-ldi=0xec25808]'\n- '  gateway array update type-time 1 Mar  5 13:35:19.641'\n- ' LDI Update time Mar  5 13:35:19.643'\n- ' LW-LDI-TS Mar  5 13:35:19.643'\n- '   via 23.0.0.3/32, GigabitEthernet0/0/0/0, 14 dependencies, weight 0, class 0, protected [flags 0x400]'\n- '    path-idx 0 bkup-idx 1 NHID 0x0 [0xddb6db0 0xddb6db0]'\n- '    next hop 23.0.0.3/32'\n- '     local label 16005      labels imposed {16005}'\n- '   via 26.0.0.6/32, GigabitEthernet0/0/0/1, 18 dependencies, weight 0, class 0, backup (TI-LFA) [flags 0xb00]'\n- '    path-idx 1 NHID 0x0 [0xf399fb0 0x0]'\n- '    next hop 26.0.0.6/32, Repair Node(s): 6.6.6.6, 7.7.7.7'\n- '    remote adjacency'\n- '     local label 16005      labels imposed {ImplNull 24023 16005}'\n- ''\n- '    Load distribution: 0 (refcount 5)'\n- ''\n- '    Hash  OK  Interface                 Address'\n- '    0     Y   GigabitEthernet0/0/0/0    remote'\n</code></pre>"},{"location":"all_inclusive_play/#ti-lfa-global-weighted-srlg-protection","title":"TI-LFA Global Weighted SRLG Protection","text":"TI-LFA Global Weighted SRLG Protection <pre><code>PLAY [13. CISCO XRV9K SR WITH TI-LFA LAB PLAYBOOK - TI-LFA GLOBAL WEIGHTED SRLG PROTECTION] ***\nTASK [13.0 RENDER AND DISPLAY THE TI-LFA GLOBAL WEIGHTED SRLG PROTECTION CONFIGURATION] ***\nok: [P2] =&gt; msg:\n- 'template: tilfa_ns_global_srlg_p2.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  fast-reroute per-prefix srlg-protection weighted-global'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P7] =&gt; msg:\n- 'template: tilfa_ns_global_srlg_p7.j2'\n- - srlg\n- ' interface GigabitEthernet0/0/0/1'\n- '  name SRLG-100'\n- ' !'\n- ' name SRLG-100'\n- '  value 100'\n- ' !'\n- '!'\n- router isis IGP address-family ipv4 unicast advertise application lfa link-attributes srlg\n- '!'\n- ''\n- ''\nTASK [13.1 RENDER AND SAVE THE TI-LFA GLOBAL WEIGHTED SRLG PROTECTION CONFIGURATION] ***\nchanged: [P2]\nchanged: [P7]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [P2]\nTASK [13.2 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [P2] =&gt; output.dest: xrcfg/P2.tilfa_ns_gw_srlg.xrcfg\nok: [P7] =&gt; output.dest: xrcfg/P7.tilfa_ns_gw_srlg.xrcfg\nTASK [13.3 RENDER AND APPLY THE TI-LFA GLOBAL WEIGHTED SRLG PROTECTION CONFIGURATION] ***\nchanged: [P2]\nchanged: [P7]\nPausing for 60 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 seconds PAUSE FOR CONVERGENCE] *****************************************\nok: [P2]\nTASK [13.4 RUN COMMANDS TO VERIFY TI-LFA GLOBAL WEIGHTED SRLG PROTECTION] ******\nok: [P2] =&gt; (item=show isis database verbose internal P7 | utility egrep -A10 SRLG)\nok: [P2] =&gt; (item=sh isis fast-reroute 5.5.5.5/32 detail)\nok: [P2] =&gt; (item=show cef 5.5.5.5/32)\nTASK [13.5 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [P2] =&gt; (item=show isis database verbose internal P7 | utility egrep -A10 SRLG) =&gt; msg:\n- - - 'MPLS SRLG:      P3.00'\n- '      Local Interface ID: 8'\n- '      Remote Interface ID: 8'\n- '      Flags: 0x0'\n- '      SRLGs: '\n- '        [0]: 100'\n- '  TLV code:238 length:26'\n- '    Application Specific SRLG: P3.00'\n- '      L flag: 0, SA-Length 1, UDA-Length 1'\n- '      Standard Applications: 0x20 LFA'\n- '      User Defined Applications: 0x20 LFA'\n- '      Sub-TLV Length: 10'\n- '        SubTLV code:4 length:8'\n- '          Local Interface ID: 8, Remote Interface ID: 8'\n- '      SRLGs:'\n- '        [0]: 100'\n- ''\n- ' Total Level-2 LSP count: 1     Local Level-2 LSP count: 0'\nok: [P2] =&gt; (item=sh isis fast-reroute 5.5.5.5/32 detail) =&gt; msg:\n- - - 'L2 5.5.5.5/32 [30/115] Label: 16005, medium priority'\n- '   Installed Mar 05 13:36:36.156 for 00:01:00'\n- '     via 23.0.0.3, GigabitEthernet0/0/0/0, Label: 16005, P3, SRGB Base: 16000, Weight: 0'\n- '       Backup path: TI-LFA (srlg), via 26.0.0.6, GigabitEthernet0/0/0/1 P6, SRGB Base: 16000, Weight: 0, Metric: 220'\n- '       Backup tunnel: tunnel-te32769'\n- '         P node: P6.00 [6.6.6.6], Label: ImpNull'\n- '         Q node: P7.00 [7.7.7.7], Label: 24023'\n- '         Q node: P4.00 [4.4.4.4], Label: 24023'\n- '         Prefix label: 16005'\n- '         Backup-src: PE5.00'\n- '       P: No, TM: 220, LC: No, NP: No, D: No, SRLG: Yes'\n- '     src PE5.00-00, 5.5.5.5, prefix-SID index 5, R:0 N:1 P:0 E:0 V:0 L:0, Alg:0'\nok: [P2] =&gt; (item=show cef 5.5.5.5/32) =&gt; msg:\n- - - 5.5.5.5/32, version 4686, labeled SR, internal 0x1000001 0x8310 (ptr 0xe831138) [1], 0x600 (0xe1a0020), 0xa28 (0xf4b4650)\n- ' Updated Mar  5 13:36:36.160 '\n- ' remote adjacency to GigabitEthernet0/0/0/0'\n- ' Prefix Len 32, traffic index 0, precedence n/a, priority 1'\n- '  gateway array (0xe008a58) reference count 3, flags 0x500068, source rib (7), 1 backups'\n- '                [2 type 5 flags 0x8401 (0xec24308) ext 0x0 (0x0)]'\n- '  LW-LDI[type=5, refc=3, ptr=0xe1a0020, sh-ldi=0xec24308]'\n- '  gateway array update type-time 1 Mar  5 13:36:36.160'\n- ' LDI Update time Mar  5 13:36:36.160'\n- ' LW-LDI-TS Mar  5 13:36:36.160'\n- '   via 0.0.0.0/32, tunnel-te32769, 9 dependencies, weight 0, class 0, backup (Local-LFA) [flags 0x300]'\n- '    path-idx 0 NHID 0x0 [0xf399a10 0x0]'\n- '    next hop 0.0.0.0/32'\n- '    local adjacency'\n- '     local label 16005      labels imposed {16005}'\n- '   via 23.0.0.3/32, GigabitEthernet0/0/0/0, 8 dependencies, weight 0, class 0, protected [flags 0x400]'\n- '    path-idx 1 bkup-idx 0 NHID 0x0 [0xddb7260 0x0]'\n- '    next hop 23.0.0.3/32'\n- '     local label 16005      labels imposed {16005}'\n- ''\n- '    Load distribution: 0 (refcount 2)'\n- ''\n- '    Hash  OK  Interface                 Address'\n- '    0     Y   GigabitEthernet0/0/0/0    remote'\nTASK [13.6 RENDER AND DISPLAY THE TI-LFA GLOBAL WEIGHTED SRLG REVERSAL CONFIGURATION] ***\nok: [P2] =&gt; msg:\n- 'template: tilfa_ns_global_srlg_revert_p2.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  no fast-reroute per-prefix srlg-protection weighted-global'\n- ' !'\n- '!'\n- ''\n- ''\nok: [P7] =&gt; msg:\n- 'template: tilfa_ns_global_srlg_revert_p7.j2'\n- - no router isis IGP address-family ipv4 unicast advertise application lfa link-attributes srlg\n- '!'\n- ''\n- ''\nTASK [13.7 RENDER AND SAVE THE TI-LFA GLOBAL WEIGHTED SRLG REVERSAL CONFIGURATION] ***\nok: [P2]\nok: [P7]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [P2]\nTASK [13.8 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [P7] =&gt; output.dest: xrcfg/P7.tilfa_ns_gw_srlg_revert.xrcfg\nok: [P2] =&gt; output.dest: xrcfg/P2.tilfa_ns_gw_srlg_revert.xrcfg\nTASK [13.9 RENDER AND APPLY THE TI-LFA GLOBAL WEIGHTED SRLG REVERSAL CONFIGURATION] ***\nchanged: [P7]\nchanged: [P2]\n</code></pre>"},{"location":"all_inclusive_play/#ti-lfa-node-srlg-protection","title":"TI-LFA Node + SRLG Protection","text":"TI-LFA Node + SRLG Protection <pre><code>PLAY [14. CISCO XRV9K SR WITH TI-LFA LAB PLAYBOOK - TI-LFA NODE + SRLG PROTECTION] ***\nTASK [14.0 RENDER AND DISPLAY THE TI-LFA NODE + SRLG PROTECTION CONFIGURATION] ***\nok: [P2] =&gt; msg:\n- 'template: tilfa_ns_node.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  fast-reroute per-prefix tiebreaker node-protecting index 200'\n- ' !'\n- '!'\n- ''\n- ''\nTASK [14.1 RENDER AND SAVE THE TI-LFA NODE + SRLG PROTECTION CONFIGURATION] ****\nok: [P2]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [P2]\nTASK [14.2 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [P2] =&gt; output.dest: xrcfg/P2.tilfa_ns_node_plus_srlg.xrcfg\nTASK [14.3 RENDER AND APPLY THE TI-LFA NODE + SRLG PROTECTION CONFIGURATION] ***\nchanged: [P2]\nPausing for 60 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 seconds PAUSE FOR CONVERGENCE] *****************************************\nok: [P2]\nTASK [14.4 RUN COMMANDS TO VERIFY TI-LFA NODE + SRLG PROTECTION] ***************\nok: [P2] =&gt; (item=show isis fast-reroute 5.5.5.5/32 detail)\nok: [P2] =&gt; (item=show cef 5.5.5.5/32)\nTASK [14.5 DISPLAY OUTPUT FOR THE COMMANDS RUN IN THE PREVIOUS TASK] ***********\nok: [P2] =&gt; (item=show isis fast-reroute 5.5.5.5/32 detail) =&gt; msg:\n- - - 'L2 5.5.5.5/32 [30/115] Label: 16005, medium priority'\n- '   Installed Mar 05 13:37:54.963 for 00:01:02'\n- '     via 23.0.0.3, GigabitEthernet0/0/0/0, Label: 16005, P3, SRGB Base: 16000, Weight: 0'\n- '       Backup path: TI-LFA (node+srlg), via 26.0.0.6, GigabitEthernet0/0/0/1 P6, SRGB Base: 16000, Weight: 0, Metric: 220'\n- '       Backup tunnel: tunnel-te32769'\n- '         P node: P6.00 [6.6.6.6], Label: ImpNull'\n- '         Q node: P7.00 [7.7.7.7], Label: 24023'\n- '         Q node: P4.00 [4.4.4.4], Label: 24023'\n- '         Prefix label: 16005'\n- '         Backup-src: PE5.00'\n- '       P: No, TM: 220, LC: No, NP: Yes, D: No, SRLG: Yes'\n- '     src PE5.00-00, 5.5.5.5, prefix-SID index 5, R:0 N:1 P:0 E:0 V:0 L:0, Alg:0'\nok: [P2] =&gt; (item=show cef 5.5.5.5/32) =&gt; msg:\n- - - 5.5.5.5/32, version 4714, labeled SR, internal 0x1000001 0x8310 (ptr 0xe831138) [1], 0x600 (0xe1a0020), 0xa28 (0xf4b4180)\n- ' Updated Mar  5 13:37:54.966 '\n- ' remote adjacency to GigabitEthernet0/0/0/0'\n- ' Prefix Len 32, traffic index 0, precedence n/a, priority 1'\n- '  gateway array (0xe009e48) reference count 3, flags 0x500068, source rib (7), 1 backups'\n- '                [2 type 5 flags 0x8401 (0xec24a88) ext 0x0 (0x0)]'\n- '  LW-LDI[type=5, refc=3, ptr=0xe1a0020, sh-ldi=0xec24a88]'\n- '  gateway array update type-time 1 Mar  5 13:37:54.966'\n- ' LDI Update time Mar  5 13:37:54.966'\n- ' LW-LDI-TS Mar  5 13:37:54.966'\n- '   via 0.0.0.0/32, tunnel-te32769, 9 dependencies, weight 0, class 0, backup (Local-LFA) [flags 0x300]'\n- '    path-idx 0 NHID 0x0 [0xf399a10 0x0]'\n- '    next hop 0.0.0.0/32'\n- '    local adjacency'\n- '     local label 16005      labels imposed {16005}'\n- '   via 23.0.0.3/32, GigabitEthernet0/0/0/0, 8 dependencies, weight 0, class 0, protected [flags 0x400]'\n- '    path-idx 1 bkup-idx 0 NHID 0x0 [0xddb6720 0x0]'\n- '    next hop 23.0.0.3/32'\n- '     local label 16005      labels imposed {16005}'\n- ''\n- '    Load distribution: 0 (refcount 2)'\n- ''\n- '    Hash  OK  Interface                 Address'\n- '    0     Y   GigabitEthernet0/0/0/0    remote'\nTASK [14.6 RUN AND PARSE WITH TTP(TEMPLATE TEXT PARSER) TO CAPTURE TUNNEL-ID] ***\nok: [P2]\nTASK [14.7 DISPLAY OUTPUT FOR THE COMMANDS RUN IN THE PREVIOUS TASK] ***********\nok: [P2] =&gt; msg:\n- show cef 5.5.5.5/32\n- - - tunnelid: '32769'\nTASK [14.8 USE THE CAPTURED TUNNEL-ID TO VERIFY LABEL STACK] *******************\nok: [P2]\nTASK [14.9 DISPLAY OUTPUT FOR THE COMMANDS RUN IN THE PREVIOUS TASK] ***********\nok: [P2] =&gt; msg:\n- show mpls traffic-eng tunnels 32769\n- - 'Name: tunnel-te32769  Destination: 0.0.0.0  Ifhandle:0x94 (auto-tunnel for ISIS IGP)'\n- '  Signalled-Name: auto_P2_t32769'\n- '  Status:'\n- '    Admin:    up Oper:   up   Path:  valid   Signalling: connected'\n- ''\n- '    path option (_te32769), preference 10, (verbatim Segment-Routing) type explicit (_te32769) (Basis for Setup)'\n- '    G-PID: 0x0800 (derived from egress interface properties)'\n- '    Bandwidth Requested: 0 kbps  CT0'\n- '    Creation Time: Sun Mar  5 13:36:35 2023 (00:02:26 ago)'\n- '  Config Parameters:'\n- '    Bandwidth:        0 kbps (CT0) Priority:  7  7 Affinity: 0x0/0xffff'\n- '    Metric Type: TE (global)'\n- '    Path Selection:'\n- '      Tiebreaker: Min-fill (default)'\n- '      Protection: any (default)'\n- '    Hop-limit: disabled'\n- '    Cost-limit: disabled'\n- '    Delay-limit: disabled'\n- '    Delay-measurement: disabled'\n- '    Path-invalidation timeout: 10000 msec (default), Action: Tear (default)'\n- '    AutoRoute: disabled  LockDown: disabled   Policy class: not set'\n- '    Forward class: 0 (not enabled)'\n- '    Forwarding-Adjacency: disabled'\n- '    Autoroute Destinations: 0'\n- '    Loadshare:          0 equal loadshares'\n- '    Auto-bw: disabled'\n- '    Auto-Capacity: Disabled:'\n- '    Path Protection: Not Enabled'\n- '    BFD Fast Detection: Disabled'\n- '    Reoptimization after affinity failure: Enabled'\n- '    SRLG discovery: Disabled'\n- '  History:'\n- '    Tunnel has been up for: 00:02:26 (since Sun Mar 05 13:36:35 UTC 2023)'\n- '    Current LSP:'\n- '      Uptime: 00:02:26 (since Sun Mar 05 13:36:35 UTC 2023)'\n- ''\n- '  Segment-Routing Path Info (IGP information is not used)'\n- '    Segment0[First Hop]: 26.0.0.6, Label: -'\n- '    Segment1[ - ]: Label: 24023'\n- '    Segment2[ - ]: Label: 24023'\n- ''\n- Displayed 1 (of 1) heads, 0 (of 0) midpoints, 0 (of 0) tails\n- Displayed 1 up, 0 down, 0 recovering, 0 recovered heads\n</code></pre>"},{"location":"all_inclusive_play/#ti-lfa-tiebreaker-link-vs-srlg-vs-node","title":"TI-LFA Tiebreaker (Link vs SRLG vs Node)","text":"SR + TI-LFA Base Topology <pre><code>PLAY [15. CISCO XRV9K SR WITH TI-LFA LAB PLAYBOOK - TI-LFA TIEBREAKER LINK vs NODE vs SRLG PROTECTION] ***\nTASK [15.0 RENDER AND DISPLAY P9 PREP CONFIGURATION] ***************************\nok: [P9] =&gt; msg:\n- 'template: prep_p9.j2'\n- - ''\n- hostname P9\n- root\n- ''\n- interface Loopback0\n- ' ipv4 address 9.9.9.9/32'\n- ' description System_Loopback_Interface'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/3\n- ' ipv4 address 39.0.0.9/24'\n- ' description P9_to_P3'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- interface GigabitEthernet0/0/0/5\n- ' ipv4 address 29.0.0.9/24'\n- ' description P9_to_P2'\n- ' no shutdown'\n- '!'\n- root\n- ''\n- router isis IGP\n- ' is-type level-2-only'\n- ' net 49.0000.0000.0009.00'\n- ' log adjacency changes'\n- ' address-family ipv4 unicast'\n- '  mpls ldp auto-config'\n- '  metric-style wide level 2'\n- ' !'\n- ' interface Loopback0'\n- '  passive'\n- '  address-family ipv4 unicast'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/3'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  interface GigabitEthernet0/0/0/5'\n- '  circuit-type level-2-only'\n- '  point-to-point'\n- '  hello-padding disable'\n- '  address-family ipv4 unicast'\n- '   metric 10'\n- '  !'\n- ' !'\n- '  !'\n- root\n- ''\n- mpls oam\n- '!'\n- mpls ldp\n- ' log'\n- '  neighbor'\n- ' !'\n- '!'\n- root\n- '!'\n- ''\n- router isis IGP\n- ' address-family ipv4 unicast'\n- '  segment-routing mpls'\n- ' !'\n- ' interface Loopback0'\n- '  address-family ipv4 unicast'\n- '   prefix-sid index 9'\n- '  !'\n- ' !'\n- '!'\n- ''\n- router isis IGP\n- ' address-family ipv4 unicast'\n- '  no mpls ldp auto-config'\n- ' !'\n- '!'\n- ''\n- router isis IGP\n- ' address-family ipv4 unicast'\n- '  segment-routing mpls sr-prefer'\n- ' !'\n- '!'\n- ''\n- router isis IGP interface GigabitEthernet0/0/0/3 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/3 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- router isis IGP interface GigabitEthernet0/0/0/5 address-family ipv4 unicast fast-reroute per-prefix\n- router isis IGP interface GigabitEthernet0/0/0/5 address-family ipv4 unicast fast-reroute per-prefix ti-lfa\n- '!'\n- '!'\n- ''\n- ''\nTASK [15.1 RENDER AND SAVE P9 PREP CONFIGURATION] ******************************\nok: [P9]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [P2]\nTASK [15.2 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [P9] =&gt; output.dest: xrcfg/P9.prep.xrcfg\nTASK [15.3 RENDER AND APPLY P9 PREP CONFIGURATION] *****************************\nchanged: [P9]\nPausing for 60 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 seconds PAUSE FOR CONVERGENCE] *****************************************\nok: [P2]\n</code></pre>"},{"location":"all_inclusive_play/#link-protection-prefer","title":"Link Protection Prefer","text":"TI-LFA Link Protection Path Preferred <pre><code>TASK [15.4 RENDER AND DISPLAY THE TI-LFA LINK PROTECTION PREFER CONFIGURATION] ***\nok: [P2] =&gt; msg:\n- 'template: tilfa_tiebrkr_prefer_link.j2'\n- - srlg\n- ' interface GigabitEthernet0/0/0/1'\n- '  name SRLG-100'\n- ' !'\n- '!'\n- ''\n- ''\nTASK [15.5 RENDER AND SAVE THE TI-LFA LINK PROTECTION PREFER CONFIGURATION] ****\nok: [P2]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [P2]\nTASK [15.6 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [P2] =&gt; output.dest: xrcfg/P2.tilfa_tiebrkr_prefer_link.xrcfg\nTASK [15.7 RENDER AND APPLY THE TI-LFA LINK PROTECTION PREFER CONFIGURATION] ***\nchanged: [P2]\nPausing for 60 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 seconds PAUSE FOR CONVERGENCE] *****************************************\nok: [P2]\nTASK [15.8 RUN COMMANDS TO VERIFY TI-LFA LINK PROTECTION PREFER] ***************\nok: [P2] =&gt; (item=show isis fast-reroute 5.5.5.5/32 detail)\nok: [P2] =&gt; (item=show route 5.5.5.5/32)\nok: [P2] =&gt; (item=show cef 5.5.5.5/32)\nTASK [15.9 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] *****************\nok: [P2] =&gt; (item=show isis fast-reroute 5.5.5.5/32 detail) =&gt; msg:\n- - - 'L2 5.5.5.5/32 [30/115] Label: 16005, medium priority'\n- '   Installed Mar 05 13:40:27.929 for 00:01:02'\n- '     via 23.0.0.3, GigabitEthernet0/0/0/0, Label: 16005, P3, SRGB Base: 16000, Weight: 0'\n- '       Backup path: LFA, via 29.0.0.9, GigabitEthernet0/0/0/5, Label: 16005, P9, SRGB Base: 16000, Weight: 0, Metric: 40'\n- '       P: No, TM: 40, LC: No, NP: No, D: No, SRLG: Yes'\n- '     src PE5.00-00, 5.5.5.5, prefix-SID index 5, R:0 N:1 P:0 E:0 V:0 L:0, Alg:0'\nok: [P2] =&gt; (item=show route 5.5.5.5/32) =&gt; msg:\n- - - Routing entry for 5.5.5.5/32\n- '  Known via \"isis IGP\", distance 115, metric 30, labeled SR, type level-2'\n- '  Installed Mar  5 13:40:27.930 for 00:01:02'\n- '  Routing Descriptor Blocks'\n- '    23.0.0.3, from 5.5.5.5, via GigabitEthernet0/0/0/0, Protected'\n- '      Route metric is 30'\n- '    29.0.0.9, from 5.5.5.5, via GigabitEthernet0/0/0/5, Backup (Local-LFA)'\n- '      Route metric is 40'\n- '  No advertising protos.'\nok: [P2] =&gt; (item=show cef 5.5.5.5/32) =&gt; msg:\n- - - 5.5.5.5/32, version 4795, labeled SR, internal 0x1000001 0x8310 (ptr 0xe831138) [1], 0x600 (0xe1a0020), 0xa28 (0xf4b4700)\n- ' Updated Mar  5 13:40:27.966 '\n- ' remote adjacency to GigabitEthernet0/0/0/0'\n- ' Prefix Len 32, traffic index 0, precedence n/a, priority 1'\n- '  gateway array (0xe008888) reference count 6, flags 0x500068, source rib (7), 1 backups'\n- '                [3 type 5 flags 0x8401 (0xec23d08) ext 0x0 (0x0)]'\n- '  LW-LDI[type=5, refc=3, ptr=0xe1a0020, sh-ldi=0xec23d08]'\n- '  gateway array update type-time 1 Mar  5 13:40:27.966'\n- ' LDI Update time Mar  5 13:40:27.966'\n- ' LW-LDI-TS Mar  5 13:40:27.966'\n- '   via 23.0.0.3/32, GigabitEthernet0/0/0/0, 10 dependencies, weight 0, class 0, protected [flags 0x400]'\n- '    path-idx 0 bkup-idx 1 NHID 0x0 [0xddb6900 0x0]'\n- '    next hop 23.0.0.3/32'\n- '     local label 16005      labels imposed {16005}'\n- '   via 29.0.0.9/32, GigabitEthernet0/0/0/5, 21 dependencies, weight 0, class 0, backup (Local-LFA) [flags 0x300]'\n- '    path-idx 1 NHID 0x0 [0xf3998d0 0x0]'\n- '    next hop 29.0.0.9/32'\n- '    remote adjacency'\n- '     local label 16005      labels imposed {16005}'\n- ''\n- '    Load distribution: 0 (refcount 3)'\n- ''\n- '    Hash  OK  Interface                 Address'\n- '    0     Y   GigabitEthernet0/0/0/0    remote'\n</code></pre>"},{"location":"all_inclusive_play/#srlg-protection-preferred","title":"SRLG Protection Preferred","text":"TI-LFA SRLG Protection Path Preferred <pre><code>TASK [15.10 RENDER AND DISPLAY THE TI-LFA SRLG PROTECTION PREFER CONFIGURATION] ***\nok: [P9] =&gt; msg:\n- 'template: tilfa_tiebrkr_prefer_srlg.j2'\n- - router isis IGP\n- ' interface GigabitEthernet0/0/0/3'\n- '  address-family ipv4 unicast'\n- '   metric 100'\n- '  !'\n- ' !'\n- '!'\n- ''\n- ''\nTASK [15.11 RENDER AND SAVE THE TI-LFA SRLG PROTECTION PREFER CONFIGURATION] ***\nok: [P9]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [P2]\nTASK [15.12 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ****************\nok: [P9] =&gt; output.dest: xrcfg/P9.tilfa_tiebrkr_prefer_srlg.xrcfg\nTASK [15.13 RENDER AND APPLY THE TI-LFA SRLG PROTECTION PREFER CONFIGURATION] ***\nchanged: [P9]\nPausing for 60 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 seconds PAUSE FOR CONVERGENCE] *****************************************\nok: [P2]\nTASK [15.14 RUN COMMANDS TO VERIFY TI-LFA SRLG PROTECTION PREFER] **************\nok: [P2] =&gt; (item=show isis fast-reroute 5.5.5.5/32 detail)\nok: [P2] =&gt; (item=show route 5.5.5.5/32)\nok: [P2] =&gt; (item=show cef 5.5.5.5/32)\nTASK [15.15 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ****************\nok: [P2] =&gt; (item=show isis fast-reroute 5.5.5.5/32 detail) =&gt; msg:\n- - - 'L2 5.5.5.5/32 [30/115] Label: 16005, medium priority'\n- '   Installed Mar 05 13:41:44.286 for 00:00:59'\n- '     via 23.0.0.3, GigabitEthernet0/0/0/0, Label: 16005, P3, SRGB Base: 16000, Weight: 0'\n- '       Backup path: TI-LFA (srlg), via 29.0.0.9, GigabitEthernet0/0/0/5 P9, SRGB Base: 16000, Weight: 0, Metric: 130'\n- '         P node: P9.00 [9.9.9.9], Label: ImpNull'\n- '         Q node: P3.00 [3.3.3.3], Label: 24003'\n- '         Prefix label: 16005'\n- '         Backup-src: PE5.00'\n- '       P: No, TM: 130, LC: No, NP: No, D: No, SRLG: Yes'\n- '     src PE5.00-00, 5.5.5.5, prefix-SID index 5, R:0 N:1 P:0 E:0 V:0 L:0, Alg:0'\nok: [P2] =&gt; (item=show route 5.5.5.5/32) =&gt; msg:\n- - - Routing entry for 5.5.5.5/32\n- '  Known via \"isis IGP\", distance 115, metric 30, labeled SR, type level-2'\n- '  Installed Mar  5 13:41:44.286 for 00:01:00'\n- '  Routing Descriptor Blocks'\n- '    23.0.0.3, from 5.5.5.5, via GigabitEthernet0/0/0/0, Protected'\n- '      Route metric is 30'\n- '    29.0.0.9, from 5.5.5.5, via GigabitEthernet0/0/0/5, Backup (TI-LFA)'\n- '      Repair Node(s): 9.9.9.9, 3.3.3.3'\n- '      Route metric is 130'\n- '  No advertising protos.'\nok: [P2] =&gt; (item=show cef 5.5.5.5/32) =&gt; msg:\n- - - 5.5.5.5/32, version 4824, labeled SR, internal 0x1000001 0x8310 (ptr 0xe831138) [1], 0x600 (0xe1a0578), 0xa28 (0xf4b4758)\n- ' Updated Mar  5 13:41:44.297 '\n- ' remote adjacency to GigabitEthernet0/0/0/0'\n- ' Prefix Len 32, traffic index 0, precedence n/a, priority 1'\n- '  gateway array (0xe006d58) reference count 6, flags 0x500068, source rib (7), 1 backups'\n- '                [5 type 4 flags 0x8401 (0xec24d28) ext 0x0 (0x0)]'\n- '  LW-LDI[type=1, refc=1, ptr=0xe1a0578, sh-ldi=0xec24d28]'\n- '  gateway array update type-time 1 Mar  5 13:41:44.297'\n- ' LDI Update time Mar  5 13:41:44.297'\n- ' LW-LDI-TS Mar  5 13:41:44.297'\n- '   via 23.0.0.3/32, GigabitEthernet0/0/0/0, 14 dependencies, weight 0, class 0, protected [flags 0x400]'\n- '    path-idx 0 bkup-idx 1 NHID 0x0 [0xddb6900 0xddb6900]'\n- '    next hop 23.0.0.3/32'\n- '     local label 16005      labels imposed {16005}'\n- '   via 29.0.0.9/32, GigabitEthernet0/0/0/5, 22 dependencies, weight 0, class 0, backup (TI-LFA) [flags 0xb00]'\n- '    path-idx 1 NHID 0x0 [0xf3998d0 0x0]'\n- '    next hop 29.0.0.9/32, Repair Node(s): 9.9.9.9, 3.3.3.3'\n- '    remote adjacency'\n- '     local label 16005      labels imposed {ImplNull 24003 16005}'\n- ''\n- '    Load distribution: 0 (refcount 5)'\n- ''\n- '    Hash  OK  Interface                 Address'\n- '    0     Y   GigabitEthernet0/0/0/0    remote'\n</code></pre>"},{"location":"all_inclusive_play/#node-protection-preferred","title":"Node Protection Preferred","text":"TI-LFA NODE Protection Path Preferred <pre><code>TASK [15.16 RENDER AND DISPLAY TI-LFA NODE PROTECTION PREFER CONFIGURATION] ****\nok: [P2] =&gt; msg:\n- 'template: tilfa_tiebrkr_prefer_node.j2'\n- - router isis IGP\n- ' address-family ipv4 unicast'\n- '  fast-reroute per-prefix tiebreaker srlg-disjoint index 255'\n- ' !'\n- '!'\n- ''\n- ''\nTASK [15.17 RENDER AND SAVE TI-LFA NODE PROTECTION PREFERCONFIGURATION] ********\nchanged: [P2]\nPausing for 1 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 secs PAUSE FOR CONVERGENCE] ********************************************\nok: [P2]\nTASK [15.18 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ****************\nok: [P2] =&gt; output.dest: xrcfg/P2.prep.xrcfg\nTASK [15.19 RENDER AND APPLY TI-LFA NODE PROTECTION PREFER CONFIGURATION] ******\nchanged: [P2]\nPausing for 60 seconds\n(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)\nTASK [1 seconds PAUSE FOR CONVERGENCE] *****************************************\nok: [P2]\nTASK [15.20 RUN COMMANDS TO VERIFY TI-LFA NODE PROTECTION PREFER] **************\nok: [P2] =&gt; (item=show isis fast-reroute 5.5.5.5/32 detail)\nok: [P2] =&gt; (item=show route 5.5.5.5/32)\nok: [P2] =&gt; (item=show cef 5.5.5.5/32)\nTASK [15.21 DISPLAY THE OUTPUT REGISTERED IN THE PREVIOUS TASK] ****************\nok: [P2] =&gt; (item=show isis fast-reroute 5.5.5.5/32 detail) =&gt; msg:\n- - - 'L2 5.5.5.5/32 [30/115] Label: 16005, medium priority'\n- '   Installed Mar 05 13:42:54.152 for 00:01:02'\n- '     via 23.0.0.3, GigabitEthernet0/0/0/0, Label: 16005, P3, SRGB Base: 16000, Weight: 0'\n- '       Backup path: TI-LFA (node), via 27.0.0.7, GigabitEthernet0/0/0/3 P7, SRGB Base: 16000, Weight: 0, Metric: 120'\n- '         P node: P7.00 [7.7.7.7], Label: ImpNull'\n- '         Q node: P4.00 [4.4.4.4], Label: 24023'\n- '         Prefix label: 16005'\n- '         Backup-src: PE5.00'\n- '       P: No, TM: 120, LC: No, NP: Yes, D: No, SRLG: No'\n- '     src PE5.00-00, 5.5.5.5, prefix-SID index 5, R:0 N:1 P:0 E:0 V:0 L:0, Alg:0'\nok: [P2] =&gt; (item=show route 5.5.5.5/32) =&gt; msg:\n- - - Routing entry for 5.5.5.5/32\n- '  Known via \"isis IGP\", distance 115, metric 30, labeled SR, type level-2'\n- '  Installed Mar  5 13:42:54.152 for 00:01:02'\n- '  Routing Descriptor Blocks'\n- '    23.0.0.3, from 5.5.5.5, via GigabitEthernet0/0/0/0, Protected'\n- '      Route metric is 30'\n- '    27.0.0.7, from 5.5.5.5, via GigabitEthernet0/0/0/3, Backup (TI-LFA)'\n- '      Repair Node(s): 7.7.7.7, 4.4.4.4'\n- '      Route metric is 120'\n- '  No advertising protos.'\nok: [P2] =&gt; (item=show cef 5.5.5.5/32) =&gt; msg:\n- - - 5.5.5.5/32, version 4841, labeled SR, internal 0x1000001 0x8310 (ptr 0xe831138) [1], 0x600 (0xe1a0578), 0xa28 (0xf4b3c00)\n- ' Updated Mar  5 13:42:54.158 '\n- ' remote adjacency to GigabitEthernet0/0/0/0'\n- ' Prefix Len 32, traffic index 0, precedence n/a, priority 1'\n- '  gateway array (0xe0099c0) reference count 6, flags 0x500068, source rib (7), 1 backups'\n- '                [5 type 4 flags 0x8401 (0xec258c8) ext 0x0 (0x0)]'\n- '  LW-LDI[type=1, refc=1, ptr=0xe1a0578, sh-ldi=0xec258c8]'\n- '  gateway array update type-time 1 Mar  5 13:42:54.158'\n- ' LDI Update time Mar  5 13:42:54.159'\n- ' LW-LDI-TS Mar  5 13:42:54.159'\n- '   via 23.0.0.3/32, GigabitEthernet0/0/0/0, 8 dependencies, weight 0, class 0, protected [flags 0x400]'\n- '    path-idx 0 bkup-idx 1 NHID 0x0 [0xddb6bd0 0xddb6bd0]'\n- '    next hop 23.0.0.3/32'\n- '     local label 16005      labels imposed {16005}'\n- '   via 27.0.0.7/32, GigabitEthernet0/0/0/3, 8 dependencies, weight 0, class 0, backup (TI-LFA) [flags 0xb00]'\n- '    path-idx 1 NHID 0x0 [0xf399970 0x0]'\n- '    next hop 27.0.0.7/32, Repair Node(s): 7.7.7.7, 4.4.4.4'\n- '    remote adjacency'\n- '     local label 16005      labels imposed {ImplNull 24023 16005}'\n- ''\n- '    Load distribution: 0 (refcount 5)'\n- ''\n- '    Hash  OK  Interface                 Address'\n- '    0     Y   GigabitEthernet0/0/0/0    remote'\nPLAY RECAP *********************************************************************\nP2                         : ok=149  changed=39   unreachable=0    failed=0    skipped=58   rescued=0    ignored=0   P3                         : ok=38   changed=14   unreachable=0    failed=0    skipped=52   rescued=0    ignored=0   P4                         : ok=39   changed=18   unreachable=0    failed=0    skipped=34   rescued=0    ignored=0   P6                         : ok=52   changed=26   unreachable=0    failed=0    skipped=29   rescued=0    ignored=0   P7                         : ok=58   changed=27   unreachable=0    failed=0    skipped=60   rescued=0    ignored=0   P8                         : ok=46   changed=22   unreachable=0    failed=0    skipped=45   rescued=0    ignored=0   P9                         : ok=12   changed=4    unreachable=0    failed=0    skipped=14   rescued=0    ignored=0   PE1                        : ok=61   changed=16   unreachable=0    failed=0    skipped=24   rescued=0    ignored=0   PE5                        : ok=26   changed=12   unreachable=0    failed=0    skipped=29   rescued=0    ignored=0   </code></pre>"}]}